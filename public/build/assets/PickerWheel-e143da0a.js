import{_ as p}from"./_plugin-vue_export-helper-c27b6911.js";import{e as c,a as o,n as d,t as w,f as S,o as g}from"./app-79f1fdd8.js";const T={props:["id"],data(){return{games:["Wolf Gold","The Dog House","Sweet Bonanza","Great Rhino","Chilli Heat","Mustang Gold","Madame Destiny","Buffalo King","Hot Safari","Peking Luck","Da Vinci's Treasure","Pirate Gold","Wild West Gold","Aztec Gems","Joker's Jewels","5 Lions Gold","Triple Tigers","Queen of Gold","Diamond Strike","Gold Rush","7 Monkeys","888 Gold","Ancient Egypt","Beowulf","Caishen's Gold","Dragon Kingdom","Fire 88","Hercules Son of Zeus","Hot Chilli","Leprechaun Song","Magic Crystals","Master Chen's Fortune","Monkey Warrior","Panda's Fortune","Queen of Atlantis","The Catfather","The Champions","Vegas Magic","Wild Gladiators","Wild Spells"],colors:["#f48a00","#022522"],isSpinning:!1,selectedAngle:0,selectedGame:null,spinDuration:2e3,showSelectedGame:!1,canvasSize:500,returnToCornerTimeout:null}},mounted(){console.log(this.id),this.drawWheel(),this.pollForSpin()},methods:{pollForSpin(){setInterval(()=>{axios.get(`/api/spin/check/${this.id}`).then(t=>{console.log(t.data),t.data.shouldSpin&&(this.spinWheel(),axios.post(`/api/spin/clear/${this.id}`).catch(e=>{console.log("Error clearing spin trigger:",e)}))}).catch(t=>{console.log("Error checking spin trigger:",t)})},3e3)},drawWheel(){const t=this.$refs.wheelCanvas,e=t.getContext("2d"),a=this.games.length,l=2*Math.PI/a,s=t.width/2;e.clearRect(0,0,t.width,t.height);for(let n=0;n<a;n++){const i=n*l-Math.PI/2,r=i+l;e.fillStyle=this.colors[n%this.colors.length],e.beginPath(),e.moveTo(s,s),e.arc(s,s,s,i,r),e.closePath(),e.fill(),e.lineWidth=1,e.strokeStyle="#000",e.stroke(),e.save(),e.translate(s,s),e.rotate(i+l/2),e.textAlign="right",e.fillStyle="#fff",e.font="bold 14px Arial",e.shadowColor="rgba(0, 0, 0, 0.5)",e.shadowBlur=4,e.shadowOffsetX=2,e.shadowOffsetY=2,e.fillText(this.games[n],s-5,0),e.restore()}},spinWheel(){this.isSpinning=!0,this.showSelectedGame=!1;const t=this.games.length,e=360/t,a=Math.floor(Math.random()*t);this.selectedGame=this.games[a];const s=5*360+(360-a*e)-e/2,n=performance.now(),i=this.spinDuration,r=m=>{const u=m-n,h=Math.min(u/i,1),f=1-Math.pow(1-h,3);this.selectedAngle=f*s,this.drawRotatedWheel(),h<1?requestAnimationFrame(r):(this.showSelectedGame=!0,this.returnToCornerTimeout=setTimeout(()=>{this.isSpinning=!1,this.showSelectedGame=!1},3e3))};requestAnimationFrame(r)},drawRotatedWheel(){const t=this.$refs.wheelCanvas,e=t.getContext("2d");e.clearRect(0,0,t.width,t.height),e.save(),e.translate(t.width/2,t.height/2),e.rotate(this.selectedAngle*Math.PI/180),e.translate(-t.width/2,-t.height/2),this.drawWheel(),e.restore()},handleTransitionEnd(){!this.isSpinning&&this.returnToCornerTimeout&&(clearTimeout(this.returnToCornerTimeout),this.returnToCornerTimeout=null,this.showSelectedGame=!1)}}},_={id:"game"},v={class:"box-transform"},C=o("div",{class:"selector-arrow"},[o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[o("path",{d:"M12 21l-12-18h24z"})])],-1),G=o("img",{class:"logo",src:"https://yt3.googleusercontent.com/CfIgnRwE7ROK9CugvIS1PQOjiOUfMyruXwnHwE3FmRnHu7Utw-RjZKldzKONjXFSTUl8zCfX=s160-c-k-c0x00ffffff-no-rj",alt:""},null,-1),x=["width","height"],k={key:0,class:"selected-game"};function M(t,e,a,l,s,n){return g(),c("div",_,[o("div",{class:d(["wheel-container",{centered:s.isSpinning}]),onTransitionend:e[0]||(e[0]=(...i)=>n.handleTransitionEnd&&n.handleTransitionEnd(...i))},[o("div",v,[C,G,o("canvas",{class:d([{idle:!s.isSpinning&&!s.showSelectedGame}]),ref:"wheelCanvas",width:s.canvasSize,height:s.canvasSize},null,10,x),s.showSelectedGame?(g(),c("div",k,w(s.selectedGame),1)):S("",!0)])],34)])}const y=p(T,[["render",M]]);export{y as default};
