import{S}from"./SvgBh-b8048dc3.js";import{_ as C}from"./_plugin-vue_export-helper-c27b6911.js";import{e as a,a as t,Y as n,t as i,g as u,n as g,F as h,h as _,f as c,o as r}from"./app-b7944254.js";const w={components:{SvgBh:S},props:["id"],data(){return{loading:!0,settings:{},bonusBattleInfo:[],bonusBattleConcurrents:[],bonusBattleStage:[],bonusBattleBracket:[],bonusBattleScores:[],bonusBattleWinner:[],bonusBattleAllConcurrents:[],bonusBattleAllBracketsCurentStage:[],battleWinner:[],avgScore:0,bestScore:0,totalProfit:0,totalCost:0,isUpdating:!1,vsImageUrl:"/storage/assets/images/vs.gif"}},computed:{totalConcurrents(){return this.bonusBattleAllConcurrents.length},totalBalanceScore(){return((this.totalCost+this.totalProfit)/this.totalCost).toFixed(2)}},async mounted(){await this.getSettings(),await this.getActiveBonusBattle(),this.loading=!1,await this.updateTheListFromTimeToTime()},methods:{async getActiveBonusBattle(){await axios.get("/api/bonus-battle-info/"+this.id).then(o=>{this.bonusBattleInfo=o.data.battle,this.bonusBattleConcurrents=o.data.concurrents,this.bonusBattleAllConcurrents=o.data.all_concurrents,this.bonusBattleAllBracketsCurentStage=o.data.stage_brackets,this.bonusBattleStage=o.data.stage,this.bonusBattleBracket=o.data.bracket,this.bonusBattleScores=o.data.current_score,this.bonusBattleWinner=o.data.winner,this.battleWinner=o.data.battle_winner,this.avgScore=o.data.avg_score.toFixed(2),this.bestScore=o.data.best_score.toFixed(2),this.totalProfit=o.data.total_profit,this.totalCost=o.data.total_cost}).catch(o=>{console.log(o)})},async getSettings(){let o="obs_bonus_battle";try{const l=await axios.get("/api/get-setting-public",{params:{setting_name:o,user_id:this.id}});l.data.setting_value&&(this.settings=JSON.parse(l.data.setting_value)),console.log(this.settings)}catch(l){console.error(`Error loading setting "${o}":`,l),this.error=`Failed to load setting: ${o}`}},async updateTheListFromTimeToTime(){setInterval(async()=>{this.isUpdating||(this.isUpdating=!0,await this.getSettings(),await this.getActiveBonusBattle(),this.isUpdating=!1)},8e3)},getConcurrentScores(o,l){if(!o||!l)return[];const f=[];for(let p=0;p<this.bonusBattleScores.length;p++){const s=this.bonusBattleScores[p];s.bonus_concurrent_id===o&&s.bracket_id===l&&f.push(s)}return f},getGameThumbnail(o){return o?`/storage/games/${o}`:""}}},k={class:"table-container"},F={class:"header-list"},z={class:"bonus-details"},A={class:"list-cost"},P={class:"list-opened"},T={class:"details"},W={key:0,class:"main-battle"},N={class:"battle flex gap-2 align-middle items-center justify-center relative"},I={class:"flex flex-col gap-2 mt-2"},U={class:g("concurrent flex rounded-md text-white ")},V=["src"],G={class:"px-2 py-1"},j={class:"px-2 py-1"},E={class:"vs-symbol flex justify-center items-center text-2xl"},L=["src"],O={key:1,class:"w-full p-4 text-white shadow-lg flex space-x-4 winner-battle"},R={class:"text-center w-40 flex flex-col justify-center"},H=["src"],J={class:"flex-grow"},D={class:"w-full text-sm text-gray-200"},M={class:"p-1 text-right bg-gray-900 rounded-md"},Y={class:"second-battle"},q={key:0,class:"bracket-container py-2 px-2"},K={class:"participant-name"},Q={class:"result-score"},X={class:"result-score"},Z={class:"participant-name"},$={class:"shadow-md py-2 px-2"},tt={class:"overflow-x-auto"},st={class:"border border-black px-1 py-1 shrink w-0"},et={class:"border border-black px-2 py-1"},lt={class:"border border-black px-2 py-1"};function ot(o,l,f,p,s,d){var x;return s.loading?c("",!0):(r(),a("div",{key:0,class:"table-list",ref:"viewport",style:n({"background-color":s.settings.tableBgColor,border:s.settings.borderEnabled?s.settings.borderWidth+"px "+s.settings.borderColor+" solid":"unset"})},[t("div",k,[t("div",F,[t("div",{class:"header-list-title",style:n({"background-color":s.settings.headerBgColor,color:s.settings.headerFontColor,"font-size":s.settings.headerFontSize+"px"})},[t("span",null,i(s.bonusBattleInfo.title),1),t("div",z,[t("div",A,[l[0]||(l[0]=u("Miză ")),t("span",null,i(s.bonusBattleInfo.stake)+" "+i(s.settings.currency),1)]),t("div",P,[t("div",T,[t("span",null,i(d.totalConcurrents)+" Jocuri",1)])])])],4),t("div",{class:"header-details",style:n({"background-color":s.settings.subheaderBgColor,color:s.settings.subheaderFontColor,"font-size":s.settings.subheaderFontSize+"px"})},[t("div",{class:"text-center uppercase text-sm stage font-bold flex justify-center items-center",style:n({"background-color":s.settings.subheaderBgColorRound,color:s.settings.subheaderFontColorRound})},i(s.bonusBattleStage.name),5),t("div",null,[t("span",null,"AVG: "+i(s.avgScore),1)]),t("div",null,[t("span",null,"TOP: "+i(s.bestScore),1)]),t("div",null,[t("span",{class:g({"text-red-500":s.totalProfit<0,"text-green-500":s.totalProfit>=0})},i(s.totalProfit)+" "+i(s.settings.currency),3)])],4)]),(x=s.battleWinner)!=null&&x.id?(r(),a("div",O,[t("div",R,[s.battleWinner.game.image?(r(),a("img",{key:0,src:d.getGameThumbnail(s.battleWinner.game.image),alt:"Game Thumbnail",class:"w-100 auto mx-auto object-cover rounded-lg"},null,8,H)):c("",!0)]),t("div",J,[t("div",{class:"mb-4",style:n({"font-size":s.settings.headerFontSize*1.2+"px"})},[l[4]||(l[4]=t("span",{class:"font-bold mb-2"},"Winner Winner!",-1)),t("p",null,[l[2]||(l[2]=t("span",{class:"font-bold"},"Total Scor:",-1)),u(" "+i(d.totalBalanceScore),1)]),t("p",null,[l[3]||(l[3]=t("span",{class:"font-bold"},"Pentru User:",-1)),u(" "+i(s.battleWinner.for_user||"N/A"),1)])],4),t("div",{class:"bg-gray-800 rounded-md p-2",style:n({"background-color":s.settings.headerBgColor,color:s.settings.headerFontColor,"font-size":s.settings.headerFontSize+"px"})},[t("table",D,[l[7]||(l[7]=t("thead",null,[t("tr",null,[t("th",{class:"text-left p-1 border-b border-gray-700"},"Battle Info"),t("th",{class:"text-right p-1 border-b border-gray-700"},"LEI")])],-1)),t("tbody",null,[t("tr",null,[l[5]||(l[5]=t("td",{class:"p-1"},"Battle Cost",-1)),t("td",M,i(s.totalCost),1)]),t("tr",null,[l[6]||(l[6]=t("td",{class:"p-1"},"Battle Profit",-1)),t("td",{class:g(["p-1 text-right bg-gray-900 rounded-md",{"text-green-400":s.totalProfit>0,"text-red-400":s.totalProfit<0}])},i(s.totalProfit>0?"+":"")+i(s.totalProfit),3)])])])],4)])])):(r(),a("div",W,[t("div",N,[(r(!0),a(h,null,_(s.bonusBattleConcurrents,(e,m)=>{var y,B;return r(),a("div",{key:(e==null?void 0:e.id)||m,class:"w-100 grow flex-col flex gap-2 px-2 max-w-[190px]"},[t("div",I,[t("div",U,[t("img",{src:d.getGameThumbnail(e.game.image),alt:"Game Thumbnail",class:"w-[100px] rounded-lg"},null,8,V)]),(e==null?void 0:e.for_user)!==null?(r(),a("div",{key:0,class:"from-user",style:n({"background-color":s.settings.tableParticipantBgColor,color:s.settings.tableParticipantFontColor,"font-size":s.settings.tableParticipantFontSize+"px"})},i((e==null?void 0:e.for_user)||"N/A"),5)):c("",!0)]),d.getConcurrentScores(e==null?void 0:e.id,(y=s.bonusBattleBracket)==null?void 0:y.id).length>0?(r(),a("table",{key:0,style:n({color:s.settings.tableScoresFontColor,"font-size":s.settings.tableScoresFontSize+"px"}),class:"table-auto mb-2 w-full border-collapse border border-gray-700 rounded-md overflow-hidden"},[t("thead",null,[t("tr",{class:"bg-black text-white uppercase",style:n({"background-color":s.settings.tableScoresLabelBgColor})},l[1]||(l[1]=[t("th",{class:"border border-gray-700 px-1 py-1"},"Cost",-1),t("th",{class:"border border-gray-700 px-1 py-1"},"Rezultat",-1),t("th",{class:"border border-gray-700 px-1 py-1"},"Scor",-1)]),4)]),t("tbody",null,[(r(!0),a(h,null,_(d.getConcurrentScores(e==null?void 0:e.id,(B=s.bonusBattleBracket)==null?void 0:B.id),(b,v)=>(r(),a("tr",{key:b.id||v,style:n({"background-color":s.settings.tableScoresBgColor})},[t("td",G,i(b.cost_buy),1),t("td",j,i(b.result_buy),1),t("td",{class:g(["px-2 py-1 font-bold",b.score<1?"text-red-500":"text-green-500"])},i(b.score.toFixed(2)),3)],4))),128))])],4)):c("",!0)])}),128)),t("div",E,[t("img",{src:this.vsImageUrl,alt:"vs"},null,8,L)])])])),t("div",Y,[s.bonusBattleAllBracketsCurentStage.length>0?(r(),a("div",q,[(r(!0),a(h,null,_(s.bonusBattleAllBracketsCurentStage,e=>(r(),a("div",{key:e.id,class:"bracket-item"},[t("div",{class:g(["participant",{loser:e.winner!==e.participant_a&&e.winner!=="N/A"}])},[t("span",K,i(e.participant_a),1),l[8]||(l[8]=u(" - ")),t("span",Q,i(parseFloat(e.participant_a_score).toFixed(3)),1)],2),l[10]||(l[10]=t("div",{class:"vs"},"VS",-1)),t("div",{class:g(["participant",{loser:e.winner!==e.participant_b&&e.winner!=="N/A"}])},[t("span",X,i(parseFloat(e.participant_b_score).toFixed(3)),1),l[9]||(l[9]=u(" - ")),t("span",Z,i(e.participant_b),1)],2)]))),128))])):c("",!0),t("div",$,[t("div",tt,[t("table",{class:"table-auto w-full text-gray-200",style:n({"font-size":s.settings.tableBodyFontSize+"px"})},[t("tbody",null,[(r(!0),a(h,null,_(s.bonusBattleAllConcurrents,(e,m)=>(r(),a("tr",{key:e==null?void 0:e.id,style:n({"background-color":m%2===0?s.settings.tableHistoryBgOddColor:s.settings.tableHistoryBgEvenColor})},[t("td",st,i(e!=null&&e.is_eliminated?"❌":"✅"),1),t("td",et,i((e==null?void 0:e.game.name)||"N/A"),1),t("td",lt,i((e==null?void 0:e.for_user)||"N/A"),1)],4))),128))])],4)])])])])],4))}const nt=C(w,[["render",ot]]);export{nt as default};
