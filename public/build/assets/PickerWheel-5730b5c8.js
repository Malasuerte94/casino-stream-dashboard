import{_ as p}from"./_plugin-vue_export-helper-c27b6911.js";import{e as c,a as i,n as d,t as w,f as S,o as g}from"./app-4214fd62.js";const v={props:["id"],data(){return{games:["Sweet Bonanza","Gates of Olympus","The Dog House","Wolf Gold","Big Bass Bonanza","Money Train","Temple Tumble Megaways","Deadwood","Mental","Book of Shadows","Ramses","Fire in the Hole","Dead or Alive 2","Hex","Iron Bank","Book of Dead","Karen Gamblereater","Gulag","Huan","Fire Portals","Sugar","Rock Vegas","Might Of Ra","Ceva cu Vampiri","Ceva cu Lei","Nu Pragmatic","Nu Nolimit","Nu Relax"],colors:["#f48a00","#022522"],isSpinning:!1,selectedAngle:0,selectedGame:null,spinDuration:2e3,showSelectedGame:!1,canvasSize:500,returnToCornerTimeout:null}},mounted(){console.log(this.id),this.drawWheel(),this.pollForSpin()},methods:{pollForSpin(){setInterval(()=>{axios.get(`/api/spin/check/${this.id}`).then(t=>{console.log(t.data),t.data.shouldSpin&&(this.spinWheel(),axios.post(`/api/spin/clear/${this.id}`).catch(e=>{console.log("Error clearing spin trigger:",e)}))}).catch(t=>{console.log("Error checking spin trigger:",t)})},3e3)},drawWheel(){const t=this.$refs.wheelCanvas,e=t.getContext("2d"),a=this.games.length,l=2*Math.PI/a,s=t.width/2;e.clearRect(0,0,t.width,t.height);for(let n=0;n<a;n++){const o=n*l-Math.PI/2,r=o+l;e.fillStyle=this.colors[n%this.colors.length],e.beginPath(),e.moveTo(s,s),e.arc(s,s,s,o,r),e.closePath(),e.fill(),e.lineWidth=1,e.strokeStyle="#000",e.stroke(),e.save(),e.translate(s,s),e.rotate(o+l/2),e.textAlign="right",e.fillStyle="#fff",e.font="bold 14px Arial",e.shadowColor="rgba(0, 0, 0, 0.5)",e.shadowBlur=4,e.shadowOffsetX=2,e.shadowOffsetY=2,e.fillText(this.games[n],s-5,0),e.restore()}},spinWheel(){this.isSpinning=!0,this.showSelectedGame=!1;const t=this.games.length,e=360/t,a=Math.floor(Math.random()*t);this.selectedGame=this.games[a];const s=5*360+(360-a*e)-e/2,n=performance.now(),o=this.spinDuration,r=m=>{const u=m-n,h=Math.min(u/o,1),f=1-Math.pow(1-h,3);this.selectedAngle=f*s,this.drawRotatedWheel(),h<1?requestAnimationFrame(r):(this.showSelectedGame=!0,this.returnToCornerTimeout=setTimeout(()=>{this.isSpinning=!1,this.showSelectedGame=!1},3e3))};requestAnimationFrame(r)},drawRotatedWheel(){const t=this.$refs.wheelCanvas,e=t.getContext("2d");e.clearRect(0,0,t.width,t.height),e.save(),e.translate(t.width/2,t.height/2),e.rotate(this.selectedAngle*Math.PI/180),e.translate(-t.width/2,-t.height/2),this.drawWheel(),e.restore()},handleTransitionEnd(){!this.isSpinning&&this.returnToCornerTimeout&&(clearTimeout(this.returnToCornerTimeout),this.returnToCornerTimeout=null,this.showSelectedGame=!1)}}},_={id:"game"},T={class:"box-transform"},x=i("div",{class:"selector-arrow"},[i("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[i("path",{d:"M12 21l-12-18h24z"})])],-1),C=i("img",{class:"logo",src:"https://yt3.googleusercontent.com/CfIgnRwE7ROK9CugvIS1PQOjiOUfMyruXwnHwE3FmRnHu7Utw-RjZKldzKONjXFSTUl8zCfX=s160-c-k-c0x00ffffff-no-rj",alt:""},null,-1),k=["width","height"],G={key:0,class:"selected-game"};function A(t,e,a,l,s,n){return g(),c("div",_,[i("div",{class:d(["wheel-container",{centered:s.isSpinning}]),onTransitionend:e[0]||(e[0]=(...o)=>n.handleTransitionEnd&&n.handleTransitionEnd(...o))},[i("div",T,[x,C,i("canvas",{class:d([{idle:!s.isSpinning&&!s.showSelectedGame}]),ref:"wheelCanvas",width:s.canvasSize,height:s.canvasSize},null,10,k),s.showSelectedGame?(g(),c("div",G,w(s.selectedGame),1)):S("",!0)])],34)])}const B=p(v,[["render",A]]);export{B as default};
