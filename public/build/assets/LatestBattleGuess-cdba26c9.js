import{p as m,c as l,b as e,F as c,E as u,k as g,a as B,w as M,T as P,h as p,a9 as h,t as a,o}from"./app-d57d0c87.js";import{_ as N}from"./_plugin-vue_export-helper-c27b6911.js";const W={props:{latestBattle:{type:Object,required:!0},currency:{type:String,required:!1,default:"RON"}},data(){return{gameWinner:0,gameLowestMulti:0,gameHighestMulti:0,existingPrediction:null,notification:null,winners:null,notPredicted:!1,winnerTitles:{winner:"C칙탳tig캒torul Turneului",high:"Jocul cu cea mai mare plat캒",low:"Jocul cu cea mai mic캒 plat캒"}}},async mounted(){await this.fetchExistingPrediction(),this.latestBattle.battle.is_open||await this.fetchWinners()},methods:{async fetchExistingPrediction(){try{const s=await m.get(`/api/viewer/get-bb-prediction/${this.latestBattle.battle.id}`);s.data&&s.data.prediction?(this.notPredicted=!1,this.existingPrediction=s.data.prediction,this.gameWinner=s.data.prediction.gameWinner,this.gameLowestMulti=s.data.prediction.gameLowestMulti,this.gameHighestMulti=s.data.prediction.gameHighestMulti):this.latestBattle.battle.is_open||(this.notPredicted=!0)}catch(s){this.$page.props.user.id||(this.notPredicted=!0),console.error("Error fetching existing prediction:",s)}},async submitPredictions(){if(!this.latestBattle.battle.is_open)return;const s={gameWinner:this.gameWinner,gameLowestMulti:this.gameLowestMulti,gameHighestMulti:this.gameHighestMulti,battleId:this.latestBattle.battle.id};try{const i=await m.post("/api/viewer/add-bb-prediction",s);this.notification=i.data.message,await this.fetchExistingPrediction(),setTimeout(()=>this.notification=null,3e3)}catch(i){console.error("Error submitting predictions:",i),this.notification="Eroare la trimiterea predic탵iei!",setTimeout(()=>this.notification=null,3e3)}},async fetchWinners(){try{const s=await m.get(`/api/bb/get-winners/${this.latestBattle.battle.id}`);s.data&&s.data.winners?this.winners=s.data.winners:this.winners=null}catch{this.winners=null,console.error("No winners found.")}},getGameName(s){const i=this.latestBattle.participants.find(n=>n.id===s);return i?i.game.name:"Necunoscut"}},watch:{latestBattle(){this.fetchExistingPrediction(),this.fetchWinners()}}},L={key:0,class:"backdrop-blur-xl bg-white/10 shadow-lg shadow-black/40 border border-white/20 p-4 rounded-lg gap-4 flex flex-col text-white relative"},T={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},E=["src"],G={key:1,class:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center text-white text-xs"},H={class:"flex flex-col"},C={class:"text-gray-300 text-xs uppercase"},J={class:"font-semibold text-white"},V={key:1,class:"relative"},U={class:"backdrop-blur-xl bg-white/10 shadow-lg shadow-black/40 border border-white/20 p-4 rounded-lg gap-4 flex flex-col text-white relative"},j={key:0,class:"absolute top-0 left-0 right-0 bg-green-600 text-white p-2 rounded-t-lg text-center"},S={class:"grid grid-cols-2 gap-4"},q={class:"flex flex-col gap-1"},A=["value"],D={class:"flex flex-col gap-1"},F=["value"],O={class:"grid grid-cols-2 gap-4"},I={class:"flex flex-col gap-1"},R=["value"],z={class:"flex flex-col justify-end"},K=["disabled"],Q={key:0,class:"absolute inset-0 bg-black/30 backdrop-blur-md flex items-center justify-center rounded-lg p-0"},X={class:"p-1 rounded-lg text-white"},Y={key:0,class:"flex flex-col text-xs"},Z={class:"w-full mt-2 border border-gray-700 rounded-lg flex flex-row"},$={class:"flex flex-col"},tt={class:"border-b border-gray-700 flex flex-row"},et={class:"p-2"},it={class:"border-b border-gray-700 flex flex-row"},st={class:"p-2"},lt={class:"border-b border-gray-700 flex flex-row"},ot={class:"p-2"},rt={key:1,class:"text-sm font-semibold text-left"};function at(s,i,n,nt,r,d){var f;return o(),l(c,null,[r.winners?(o(),l("div",L,[i[4]||(i[4]=e("div",{class:"text-lg font-semibold text-center mb-2"},"游끥 C칙탳tig캒tori 游끥",-1)),e("div",T,[(o(!0),l(c,null,u(r.winners,t=>{var b,x,_,v,y,w,k;return o(),l("div",{key:t.key,class:"flex items-center gap-3 bg-gray-900/80 p-4 rounded-lg shadow-lg border border-gray-700"},[(x=(b=t==null?void 0:t.prediction)==null?void 0:b.user)!=null&&x.profile_photo_path?(o(),l("img",{key:0,src:t.prediction.user.profile_photo_path,alt:"User Avatar",class:"w-10 h-10 rounded-full border border-gray-600"},null,8,E)):(o(),l("div",G," 游끤 ")),e("div",H,[e("div",C,a(r.winnerTitles[t.key]),1),e("div",J,a(((v=(_=t==null?void 0:t.prediction)==null?void 0:_.user)==null?void 0:v.yt_name)||((w=(y=t==null?void 0:t.prediction)==null?void 0:y.user)==null?void 0:w.name)||"N/A"),1),e("div",null,[e("span",null,a((k=t==null?void 0:t.game)==null?void 0:k.name),1)])])])}),128))])])):g("",!0),(f=n.latestBattle)!=null&&f.battle?(o(),l("div",V,[e("div",U,[B(P,{name:"fade"},{default:M(()=>[r.notification?(o(),l("div",j,a(r.notification),1)):g("",!0)]),_:1}),i[8]||(i[8]=e("div",{class:"font-semibold"},"Predic탵ii Turneu",-1)),e("div",S,[e("div",q,[i[5]||(i[5]=e("label",{for:"highestMulti",class:"text-gray-300"},"Jocul cu cea mai mare plat캒 (x)",-1)),p(e("select",{id:"bestGame","onUpdate:modelValue":i[0]||(i[0]=t=>r.gameHighestMulti=t),class:"bg-gray-900 text-white border border-gray-700 rounded p-2 outline-none focus:ring focus:ring-green-500"},[(o(!0),l(c,null,u(n.latestBattle.participants,t=>(o(),l("option",{key:t.id,value:t.id},a(t.game.name),9,A))),128))],512),[[h,r.gameHighestMulti]])]),e("div",D,[i[6]||(i[6]=e("label",{for:"lowestMulti",class:"text-gray-300"},"Jocul cu cea mai mic캒 plat캒 (x)",-1)),p(e("select",{id:"bestGame","onUpdate:modelValue":i[1]||(i[1]=t=>r.gameLowestMulti=t),class:"bg-gray-900 text-white border border-gray-700 rounded p-2 outline-none focus:ring focus:ring-green-500"},[(o(!0),l(c,null,u(n.latestBattle.participants,t=>(o(),l("option",{key:t.id,value:t.id},a(t.game.name),9,F))),128))],512),[[h,r.gameLowestMulti]])])]),e("div",O,[e("div",I,[i[7]||(i[7]=e("label",{for:"bestGame",class:"text-gray-300"},"C칙탳tig캒torul",-1)),p(e("select",{id:"bestGame","onUpdate:modelValue":i[2]||(i[2]=t=>r.gameWinner=t),class:"bg-gray-900 text-white border border-gray-700 rounded p-2 outline-none focus:ring focus:ring-green-500"},[(o(!0),l(c,null,u(n.latestBattle.participants,t=>(o(),l("option",{key:t.id,value:t.id},a(t.game.name),9,R))),128))],512),[[h,r.gameWinner]])]),e("div",z,[e("button",{onClick:i[3]||(i[3]=(...t)=>d.submitPredictions&&d.submitPredictions(...t)),class:"bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300",disabled:!n.latestBattle.battle.is_open},a(r.existingPrediction?"Update Predic탵ii":"Trimite Predic탵ii"),9,K)])])]),!s.$page.props.user.id||!n.latestBattle.battle.is_open?(o(),l("div",Q,[e("div",X,[r.notPredicted?(o(),l("div",rt,"Nu ai predic탵ii pentru acest battle")):(o(),l("div",Y,[i[12]||(i[12]=e("div",{class:"text-sm font-semibold text-left"},"Predic탵iile tale",-1)),e("div",Z,[e("div",$,[e("div",tt,[i[9]||(i[9]=e("div",{class:"p-2"},"Jocul care pl캒te탳te cel mai mult",-1)),e("div",et,a(d.getGameName(r.gameLowestMulti)),1)]),e("div",it,[i[10]||(i[10]=e("div",{class:"p-2"},"Jocul care pl캒te탳te cel mai pu탵in",-1)),e("div",st,a(d.getGameName(r.gameHighestMulti)),1)]),e("div",lt,[i[11]||(i[11]=e("div",{class:"p-2"},"C칙탳tig캒torul Turneului",-1)),e("div",ot,a(d.getGameName(r.gameWinner)),1)])])])]))])])):g("",!0)])):g("",!0)],64)}const ut=N(W,[["render",at]]);export{ut as default};
