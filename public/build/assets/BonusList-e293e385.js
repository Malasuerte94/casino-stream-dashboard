import{S as _}from"./SvgBh-e6bcdd4d.js";import{_ as f}from"./_plugin-vue_export-helper-c27b6911.js";import{N as L,e as o,a as t,b,t as l,g as c,Y as y,F as m,h as g,f as G,o as u,n as v}from"./app-7f970d7d.js";const S={components:{SvgBh:_},props:["id"],data(){return{loading:!0,bonusList:[],bonusListGames:[],settings:null,isUpdating:!1,scrollSpeed:500,itWasDuplicated:!0}},computed:{startAmount(){return this.bonusList.start??0},huntOrBuy(){var s;return((s=this.settings)==null?void 0:s.bonus_list)==="buy"?"Buy":"Hunt"},duplicatedGames(){return this.shouldScroll()?(this.itWasDuplicated=!0,[...this.bonusListGames,...this.bonusListGames]):(this.itWasDuplicated=!1,this.bonusListGames)},firstEmptyResultId(){const s=this.bonusListGames.find(e=>e.result==="0");return s?s.id:null},gamesOpenedNr(){return this.bonusListGames.filter(s=>s.result&&s.result!=="0").length},gamesTotalNr(){return this.bonusListGames.length},gamesRemainingNr(){return this.bonusListGames.filter(s=>!s.result||s.result==="0").length},gameHighestMulti(){const s=this.bonusListGames.map(e=>e!=null&&e.multiplier?parseFloat(e.multiplier.trim()):NaN).filter(e=>!isNaN(e));return s.length?Math.max(...s):0},progressPercentage(){return this.gamesOpenedNr/this.gamesTotalNr*100},averageMulti(){const s=this.bonusListGames.filter(r=>r.result!==null&&r.result!=="0");if(s.length===0)return 0;const e=s.reduce((r,h)=>r+parseFloat(h.multiplier),0);return Math.round(e/s.length)}},async mounted(){await this.getSettings(),await this.getLatestList(),this.loading=!1,await this.$nextTick(()=>{this.initAutoScroll(this.$refs.scrollWrapper),this.initAutoScroll(this.$refs.scrollWrapperHunt)}),await this.updateTheListFromTimeToTime()},methods:{shouldScroll(){const s=this.$refs.scrollWrapper||this.$refs.scrollWrapperHunt,e=this.$refs.viewport;if(!s||!e)return!1;const r=document.querySelector(".header-list"),h=r?r.getBoundingClientRect().height:0,n=e.getBoundingClientRect().bottom-h,p=s.querySelectorAll(".game-single");if(p.length===0)return!1;let i=0;return p.forEach(a=>{i+=a.getBoundingClientRect().height}),this.itWasDuplicated&&(i=i/2),i+20>n},async getSettings(){await axios.get("/api/settings/"+this.id).then(s=>{this.settings=s.data.settings}).catch(s=>{console.log(s)})},async getLatestList(){await axios.get("/api/bonus-list/"+this.id).then(s=>{this.bonusList=s.data.bonusList,this.bonusListGames=s.data.bonusListGames}).catch(s=>{console.log(s)})},async updateTheListFromTimeToTime(){setInterval(async()=>{this.isUpdating||(this.isUpdating=!0,await this.getLatestList(),this.isUpdating=!1,this.initAutoScroll())},8e3)},initAutoScroll(){const s=this.$refs.gamesList||this.$refs.gamesListHunt;s&&(this.shouldScroll()?s.classList.add("scrolling"):s.classList.remove("scrolling"))}}},w={key:0,class:"table",ref:"viewport"},B={class:"table-container"},N={class:"header-list"},T={class:"header-list-title"},x={class:"img-list"},k={class:"bonus-details"},H={class:"list-cost"},M={class:"list-opened"},R={class:"details"},W={class:"details"},A={class:"progress"},C={class:"header-details"},F={class:"scroll-wrapper",ref:"scrollWrapper"},O={class:"games",ref:"gamesList"},z={class:"number_game"},D={class:"name_game"},E={class:"stake"},I={class:"result"},P={class:"result"},U={class:"multi"},V={class:"scroll-wrapper",ref:"scrollWrapperHunt"},q={class:"games",ref:"gamesListHunt"},J={class:"number_game"},Y={class:"name_game"},j={class:"stake"};function K(s,e,r,h,d,n){const p=L("SvgBh");return d.loading?G("",!0):(u(),o("div",w,[t("div",B,[t("div",N,[t("div",T,[t("span",x,[b(p)]),e[2]||(e[2]=t("span",null,"Bonus",-1)),t("span",null,l(n.huntOrBuy),1),t("div",k,[t("div",H,[e[0]||(e[0]=c("Cost ")),t("span",null,l(n.startAmount)+" lei",1)]),t("div",M,[t("div",R,[t("span",null,l(n.gamesOpenedNr)+"/",1)]),t("div",W,[t("span",null,l(n.gamesTotalNr),1),e[1]||(e[1]=c("m "))])])])]),t("div",A,[t("div",{class:"progress-bar-fill",style:y({width:n.progressPercentage+"%"})},null,4)]),t("div",C,[t("div",null,[e[3]||(e[3]=c("Avg (x)")),t("span",null,l(n.averageMulti),1)]),t("div",null,[e[4]||(e[4]=c("Top (x)")),t("span",null,l(n.gameHighestMulti),1)]),t("div",null,[e[5]||(e[5]=c("Rezultat")),t("span",null,l(d.bonusList.result)+" lei",1)])])]),n.huntOrBuy==="Buy"?(u(),o(m,{key:0},[e[6]||(e[6]=t("div",{class:"header"},[t("div",{class:"header-content_buy header-content"},[t("div",{class:"text-center"},"#"),t("div",null,"Joc"),t("div",null,"Miză"),t("div",null,"Preț"),t("div",null,"Plată"),t("div",null,"Multi")])],-1)),t("div",F,[t("div",O,[(u(!0),o(m,null,g(n.duplicatedGames,(i,a)=>(u(),o("div",{key:"a-"+a,class:v(["game-single row-game_buy",{current:n.firstEmptyResultId===i.id}])},[t("div",z,l(a%d.bonusListGames.length+1),1),t("div",D,l(i.name),1),t("div",E,l(i.stake),1),t("div",I,l(i.price==="0"||i.price==null?"":i.price),1),t("div",P,l(i.result==="0"||i.result==null?"":i.result),1),t("div",U,l(i.multiplier==="0"||i.multiplier==null?"":"x"+i.multiplier),1)],2))),128))],512)],512)],64)):(u(),o(m,{key:1},[e[7]||(e[7]=t("div",{class:"header"},[t("div",{class:"header-content_hunt header-content"},[t("div",{class:"text-center"},"#"),t("div",null,"Joc"),t("div",null,"Miză"),t("div",null,"Plată"),t("div",null,"Multi")])],-1)),t("div",V,[t("div",q,[(u(!0),o(m,null,g(n.duplicatedGames,(i,a)=>(u(),o("div",{key:"b-"+a,class:v(["game-single row-game_hunt",{current:n.firstEmptyResultId===i.id}])},[t("div",J,l(a%d.bonusListGames.length+1),1),t("div",Y,l(i.name),1),t("div",j,l(i.stake),1),t("div",null,l(i.result==="0"||i.result==null?"":i.result),1),t("div",null,l(i.multiplier==="0"||i.multiplier==null?"":"x"+i.multiplier),1)],2))),128))],512)],512)],64))])],512))}const $=f(S,[["render",K]]);export{$ as default};
