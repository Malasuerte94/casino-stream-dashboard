import{q as m,c as l,b as i,F as u,E as f,k as g,a as w,w as M,T as B,h,a8 as b,t as n,o as r,n as y}from"./app-ba8bfc91.js";import{_ as P}from"./_plugin-vue_export-helper-c27b6911.js";const k={props:{latestBattle:{type:Object,required:!0},currency:{type:String,required:!1,default:"RON"}},data(){return{gameWinner:0,gameLowestMulti:0,gameHighestMulti:0,existingPrediction:null,notification:null,winners:null,battleResult:null,notPredicted:!1}},async mounted(){await this.fetchExistingPrediction(),this.latestBattle.battle.is_open||await this.fetchWinners()},methods:{async fetchExistingPrediction(){try{const s=await m.get(`/api/viewer/get-bb-prediction/${this.latestBattle.battle.id}`);s.data&&s.data.prediction?(this.notPredicted=!1,this.existingPrediction=s.data.prediction,this.gameWinner=s.data.prediction.gameWinner,this.gameLowestMulti=s.data.prediction.gameLowestMulti,this.gameHighestMulti=s.data.prediction.gameHighestMulti):this.latestBattle.battle.is_open||(this.notPredicted=!0)}catch(s){this.$page.props.user.id||(this.notPredicted=!0),console.error("Error fetching existing prediction:",s)}},async submitPredictions(){if(!this.latestBattle.battle.is_open)return;const s={gameWinner:this.gameWinner,gameLowestMulti:this.gameLowestMulti,gameHighestMulti:this.gameHighestMulti,battleId:this.latestBattle.battle.id};try{const e=await m.post("/api/viewer/add-bb-prediction",s);this.notification=e.data.message,await this.fetchExistingPrediction(),setTimeout(()=>this.notification=null,3e3)}catch(e){console.error("Error submitting predictions:",e),this.notification="Eroare la trimiterea predic»õiei!",setTimeout(()=>this.notification=null,3e3)}},async fetchWinners(){try{const s=await m.get(`/api/get-bonus-winner/${this.latestBattle.battle.id}`);s.data&&s.data.winners?(this.winners=s.data.winners,this.battleResult=s.data.results):(this.winners=null,this.battleResult=null)}catch{console.error("No winners found.")}},getGameName(s){const e=this.latestBattle.participants.find(o=>o.id===s);return e?e.game.name:"Necunoscut"},formatCurrency(s){return`${Number(s).toLocaleString()} ${this.currency}`},formatMultiplier(s){return`${Number(s)}x`},formatMultiplierDifference(s,e){const o=e-s;return o>0?`+${o}x`:`${o}x`},formatDifference(s,e){const o=e-s;return o>0?`+${o.toLocaleString()} ${this.currency}`:`${o.toLocaleString()} ${this.currency}`},getDifferenceClass(s,e){return e-s>=0?"text-green-400":"text-red-400"}},watch:{latestBattle(){this.fetchExistingPrediction(),this.fetchWinners()}}},W={key:0,class:"backdrop-blur-xl bg-white/10 shadow-lg shadow-black/40 border border-white/20 p-4 rounded-lg gap-4 flex flex-col text-white relative"},N={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},L=["src"],C={key:1,class:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center text-white text-xs"},G={class:"flex flex-col"},D={class:"text-gray-300 text-xs uppercase"},E={class:"font-semibold text-white"},H={key:0},R={key:1},T={key:2},S={key:1,class:"relative"},V={class:"backdrop-blur-xl bg-white/10 shadow-lg shadow-black/40 border border-white/20 p-4 rounded-lg gap-4 flex flex-col text-white relative"},U={key:0,class:"absolute top-0 left-0 right-0 bg-green-600 text-white p-2 rounded-t-lg text-center"},j={class:"grid grid-cols-2 gap-4"},J={class:"flex flex-col gap-1"},q=["value"],A={class:"flex flex-col gap-1"},F=["value"],O={class:"grid grid-cols-2 gap-4"},z={class:"flex flex-col gap-1"},I=["value"],K={class:"flex flex-col justify-end"},Q=["disabled"],X={key:0,class:"absolute inset-0 bg-black/30 backdrop-blur-md flex items-center justify-center rounded-lg p-0"},Y={class:"p-1 rounded-lg text-white"},Z={key:0,class:"flex flex-col text-xs"},$={class:"w-full mt-2 border border-gray-700 rounded-lg flex flex-row"},ee={class:"flex flex-col"},te={class:"border-b border-gray-700 flex flex-row"},ie={class:"p-2"},se={class:"border-b border-gray-700 flex flex-row"},le={class:"p-2"},re={class:"border-b border-gray-700 flex flex-row"},ae={class:"p-2"},oe={key:1,class:"text-sm font-semibold text-left"};function ne(s,e,o,de,a,d){var p;return r(),l(u,null,[a.winners?(r(),l("div",W,[e[4]||(e[4]=i("div",{class:"text-lg font-semibold text-center mb-2"},"üèÜ C√¢»ôtigƒÉtori üèÜ",-1)),i("div",N,[(r(!0),l(u,null,f(a.winners,(t,c)=>{var x,_,v;return r(),l("div",{key:c,class:"flex items-center gap-3 bg-gray-900/80 p-4 rounded-lg shadow-lg border border-gray-700"},[(x=t==null?void 0:t.user)!=null&&x.profile_photo_path?(r(),l("img",{key:0,src:t.user.profile_photo_path,alt:"User Avatar",class:"w-10 h-10 rounded-full border border-gray-600"},null,8,L)):(r(),l("div",C," üèÖ ")),i("div",G,[i("div",D,n(s.winnerTitles[c]),1),i("div",E,n(((_=t==null?void 0:t.user)==null?void 0:_.yt_name)||((v=t==null?void 0:t.user)==null?void 0:v.name)||"N/A"),1),c==="resultWinner"?(r(),l("div",H,[i("span",null,n(d.formatCurrency(t.estimated)),1),i("span",{class:y(d.getDifferenceClass(t.estimated,a.battleResult.result))}," ("+n(d.formatDifference(t.estimated,a.battleResult.result))+") ",3)])):c==="biggestMultiplierWinner"||c==="lowestMultiplierWinner"?(r(),l("div",R,[i("span",null,n(d.formatMultiplier(t.estimated)),1),i("span",{class:y(d.getDifferenceClass(t.estimated,a.battleResult[c.replace("Winner","")]))}," ("+n(d.formatMultiplierDifference(t.estimated,a.battleResult[c.replace("Winner","")]))+") ",3)])):c==="exactBiggestMultiplierGame"||c==="exactLowestMultiplierGame"?(r(),l("div",T,[i("span",null,n(d.getGameName(t==null?void 0:t.game_id)),1)])):g("",!0)])])}),128))])])):g("",!0),(p=o.latestBattle)!=null&&p.battle?(r(),l("div",S,[i("div",V,[w(B,{name:"fade"},{default:M(()=>[a.notification?(r(),l("div",U,n(a.notification),1)):g("",!0)]),_:1}),e[8]||(e[8]=i("div",{class:"font-semibold"},"Predic»õii Turneu",-1)),i("div",j,[i("div",J,[e[5]||(e[5]=i("label",{for:"highestMulti",class:"text-gray-300"},"Jocul cu cea mai mare platƒÉ (x)",-1)),h(i("select",{id:"bestGame","onUpdate:modelValue":e[0]||(e[0]=t=>a.gameHighestMulti=t),class:"bg-gray-900 text-white border border-gray-700 rounded p-2 outline-none focus:ring focus:ring-green-500"},[(r(!0),l(u,null,f(o.latestBattle.participants,t=>(r(),l("option",{key:t.id,value:t.id},n(t.game.name),9,q))),128))],512),[[b,a.gameHighestMulti]])]),i("div",A,[e[6]||(e[6]=i("label",{for:"lowestMulti",class:"text-gray-300"},"Jocul cu cea mai micƒÉ platƒÉ (x)",-1)),h(i("select",{id:"bestGame","onUpdate:modelValue":e[1]||(e[1]=t=>a.gameLowestMulti=t),class:"bg-gray-900 text-white border border-gray-700 rounded p-2 outline-none focus:ring focus:ring-green-500"},[(r(!0),l(u,null,f(o.latestBattle.participants,t=>(r(),l("option",{key:t.id,value:t.id},n(t.game.name),9,F))),128))],512),[[b,a.gameLowestMulti]])])]),i("div",O,[i("div",z,[e[7]||(e[7]=i("label",{for:"bestGame",class:"text-gray-300"},"C√¢»ôtigƒÉtorul",-1)),h(i("select",{id:"bestGame","onUpdate:modelValue":e[2]||(e[2]=t=>a.gameWinner=t),class:"bg-gray-900 text-white border border-gray-700 rounded p-2 outline-none focus:ring focus:ring-green-500"},[(r(!0),l(u,null,f(o.latestBattle.participants,t=>(r(),l("option",{key:t.id,value:t.id},n(t.game.name),9,I))),128))],512),[[b,a.gameWinner]])]),i("div",K,[i("button",{onClick:e[3]||(e[3]=(...t)=>d.submitPredictions&&d.submitPredictions(...t)),class:"bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300",disabled:!o.latestBattle.battle.is_open},n(a.existingPrediction?"Update Predic»õii":"Trimite Predic»õii"),9,Q)])])]),!s.$page.props.user.id||!o.latestBattle.battle.is_open?(r(),l("div",X,[i("div",Y,[a.notPredicted?(r(),l("div",oe,"Nu ai predic»õii pentru acest battle")):(r(),l("div",Z,[e[12]||(e[12]=i("div",{class:"text-sm font-semibold text-left"},"Predic»õiile tale",-1)),i("div",$,[i("div",ee,[i("div",te,[e[9]||(e[9]=i("div",{class:"p-2"},"Jocul care plƒÉte»ôte cel mai mult",-1)),i("div",ie,n(d.getGameName(a.gameLowestMulti)),1)]),i("div",se,[e[10]||(e[10]=i("div",{class:"p-2"},"Jocul care plƒÉte»ôte cel mai pu»õin",-1)),i("div",le,n(d.getGameName(a.gameHighestMulti)),1)]),i("div",re,[e[11]||(e[11]=i("div",{class:"p-2"},"C√¢»ôtigƒÉtorul Turneului",-1)),i("div",ae,n(d.getGameName(a.gameWinner)),1)])])])]))])])):g("",!0)])):g("",!0)],64)}const ge=P(k,[["render",ne]]);export{ge as default};
