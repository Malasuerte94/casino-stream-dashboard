import{q as A,o as i,c as n,b as e,h as C,m as me,d as $,t as u,k as b,F as U,s as S,n as _,i as g,l as J,j as pe,f as ge,w as L,x as V,a as z,y as ee,u as q,T as be}from"./app-30fbd00a.js";import{_ as ye}from"./AppLayout-aff8bc9b.js";import{u as he,C as te}from"./gameStore-8eb93f67.js";import{_ as fe}from"./_plugin-vue_export-helper-c27b6911.js";import{_ as ve}from"./DialogModal-e0df6b46.js";import"./ResponsiveNavLink-0c30409f.js";const _e={name:"BattleViewerList",emits:["winnersPicked"],data(){return{battleViewers:[],winners:[],setting:!1,loading:!1}},props:{fillCount:{type:Number,required:!1}},async mounted(){await this.fetchBattleViewers(),await this.fetchSetting(),window.Echo.channel(`App.Models.User.${this.$page.props.user.id}`).listen("BattleViewerUpdated",()=>{this.fetchBattleViewers()})},methods:{async fetchBattleViewers(){try{const o=await A.get("api/bonus-battles/battle-viewers");this.battleViewers=o.data}catch(o){console.error("Failed to fetch battle viewers:",o.message)}},async fetchSetting(){if(!this.loading){this.loading=!0;try{const o=await A.get("/api/get-setting-public",{params:{setting_name:"battle_selections"}});o.data.setting_value!==void 0&&(this.setting=o.data.setting_value==1),console.log(this.setting)}catch(o){console.error("Failed to fetch setting:",o.message)}finally{this.loading=!1}}},copyText(o){if(navigator.clipboard)navigator.clipboard.writeText(o).then(()=>{alert("Comanda a fost copiată în clipboard")}).catch(a=>{console.error("Failed to copy text: ",a)});else{const a=document.createElement("input");a.value=o,document.body.appendChild(a),a.select();try{document.execCommand("copy"),console.log("Copied to clipboard")}catch(m){console.error("Failed to copy text: ",m)}document.body.removeChild(a)}},updateWinners(){this.$emit("winnersPicked",this.winners.map(o=>o.user))},getRandomItem(o){return o[Math.floor(Math.random()*o.length)]},async markAsPicked(o){try{await A.patch(`api/bonus-battles/battle-viewers/${o}`,{picked:!0})}catch(a){console.error("Failed to mark as picked:",a.message)}},async markAsEliminated(o){try{await A.patch(`api/bonus-battles/battle-viewers/${o}`,{eliminated:!0})}catch(a){console.error("Failed to mark as eliminated:",a.message)}},async pickWinner(){if(!this.loading){this.loading=!0;try{const o=this.battleViewers.filter(m=>!m.picked&&!m.eliminated);if(!o.length){console.error("No available candidates");return}const a=this.getRandomItem(o);await this.markAsPicked(a.id),a.picked=!0,this.winners.push(a),this.updateWinners()}catch(o){console.error("Error picking winner:",o)}finally{this.loading=!1}}},async fillList(){if(!this.loading){this.loading=!0;try{if(this.fillCount<0)return;const o=[];for(let a=0;a<this.fillCount;a++){const m=this.battleViewers.filter(d=>!d.picked&&!d.eliminated);if(!m.length)break;const v=this.getRandomItem(m);await this.markAsPicked(v.id),v.picked=!0,o.push(v)}this.winners=o,this.updateWinners()}catch(o){console.error("Error filling list:",o)}finally{this.loading=!1}}},clearList(){this.$dialog({message:"Ești sigur că vrei să faci o listă nouă?",buttons:["da","nu"],da:async()=>{if(!this.loading){this.loading=!0;try{await A.post("api/bonus-battles/battle-viewers/remove-all"),this.battleViewers=[],this.winners=[],this.updateWinners()}catch(o){console.error("Failed to clear the list:",o.message)}finally{this.loading=!1}}},nu:()=>console.log("Canceled reset")})},async rerollWinner(o,a){if(!this.loading){this.loading=!0;try{await this.markAsEliminated(o.id);const m=this.battleViewers.find(c=>c.id===o.id);m&&(m.eliminated=!0);const v=this.battleViewers.filter(c=>!c.picked&&!c.eliminated);if(!v.length){console.error("No available candidates for reroll");return}const d=this.getRandomItem(v);await this.markAsPicked(d.id),d.picked=!0,this.winners.splice(a,1,d),this.updateWinners()}catch(m){console.error("Error in rerollWinner:",m)}finally{this.loading=!1}}},eliminateWinner(o,a){this.$dialog({message:"Ești sigur că vrei să elimini acest utilizator?",buttons:["da","nu"],da:async()=>{if(!this.loading){this.loading=!0;try{await this.markAsEliminated(o.id),this.winners.splice(a,1);const m=this.battleViewers.find(v=>v.id===o.id);m&&(m.eliminated=!0),this.updateWinners()}catch(m){console.error("Error eliminating winner:",m)}finally{this.loading=!1}}},nu:()=>console.log("Canceled elimination")})},async updateSetting(){if(!this.loading){this.loading=!0;try{await A.post("/api/settings/save",{setting_name:"battle_selections",setting_value:this.setting})}catch(o){console.error("Error saving settings:",o)}finally{this.loading=!1}}}},computed:{apiUrlCommand(){return`{readapi.${window.location.origin}/api/add-bb-viewer/{user.name}/{1}/${this.$page.props.user.id}}`},apiUrlCommandNightBot(){return`$(urlfetch ${window.location.origin}/api/add-bb-viewer/$(user)/$(1) $(2) $(3)/${this.$page.props.user.id})`}}},xe={class:"p-2 rounded-md shadow-md md:w-1/3 bg-gray-800 space-y-4 transition-all duration-300"},we={class:"flex items-center justify-between p-2 bg-gray-700 rounded"},ke={for:"toggle",class:"relative inline-flex items-center cursor-pointer"},Ce=["disabled"],Be={class:"ml-3 text-sm font-medium text-gray-300"},Ve={key:0,class:"ml-2 text-xs italic text-gray-400"},$e={key:0,class:"overflow-auto max-h-60 border border-gray-700 rounded"},Ue={class:"min-w-full text-sm"},Se={class:"text-sm"},Ae={class:"px-2 py-2"},Fe={class:"px-2 py-2"},Te={class:"px-2 py-2"},Ee=["onClick","disabled"],Ne={key:0},Le={key:1},ze=["onClick","disabled"],We={key:0},Pe={key:1},Me={class:"overflow-auto max-h-60 border border-gray-700 rounded"},Ge={class:"min-w-full"},Re={class:"px-2 py-2"},je={class:"px-2 py-2"},Oe={class:"px-2 py-2"},He={class:"px-2 py-2"},De={class:"mt-4 flex space-x-4"},Je=["disabled"],qe={key:0},Ye={key:1},Ie=["disabled"],Ze={key:0},Ke={key:1},Qe=["disabled"],Xe={key:0},et={key:1},tt={class:"mb-4 text-sm"},st={class:"mb-4 text-sm"};function at(o,a,m,v,d,c){return i(),n("div",xe,[e("div",we,[e("label",ke,[C(e("input",{type:"checkbox",id:"toggle","onUpdate:modelValue":a[0]||(a[0]=r=>d.setting=r),onChange:a[1]||(a[1]=(...r)=>c.updateSetting&&c.updateSetting(...r)),class:"sr-only peer",disabled:d.loading},null,40,Ce),[[me,d.setting]]),a[7]||(a[7]=e("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 rounded-full dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"},null,-1)),e("span",Be,[$(u(d.setting?"Înscrieri Pornite prin Bot":"Înscrieri Oprite prin Bot")+" ",1),d.loading?(i(),n("span",Ve,"Loading...")):b("",!0)])])]),d.winners.length?(i(),n("div",$e,[e("table",Ue,[e("tbody",Se,[(i(!0),n(U,null,S(d.winners,(r,h)=>(i(),n("tr",{key:r.id,class:"text-sm"},[e("td",Ae,u(r.user),1),e("td",Fe,u(r.game),1),e("td",Te,[e("button",{onClick:F=>c.rerollWinner(r,h),class:"bg-blue-600 rounded p-1 btn-sm text-sm mr-2",disabled:d.loading},[d.loading?(i(),n("span",Ne,"Loading...")):(i(),n("span",Le,"Reroll"))],8,Ee),e("button",{onClick:F=>c.eliminateWinner(r,h),class:"bg-red-600 rounded p-1 btn-sm",disabled:d.loading},[d.loading?(i(),n("span",We,"Loading...")):(i(),n("span",Pe,"Elimină"))],8,ze)])]))),128))])])])):b("",!0),e("div",Me,[e("table",Ge,[a[8]||(a[8]=e("thead",{class:"bg-gray-900"},[e("tr",null,[e("th",{class:"px-2 py-2 text-left text-gray-300"},"User"),e("th",{class:"px-2 py-2 text-left text-gray-300"},"Joc"),e("th",{class:"px-2 py-2 text-left text-gray-300"},"Ales"),e("th",{class:"px-2 py-2 text-left text-gray-300"},"Eliminat")])],-1)),e("tbody",null,[(i(!0),n(U,null,S(d.battleViewers,r=>(i(),n("tr",{key:r.id,class:_({"bg-green-600":r.picked&&!r.eliminated,"bg-red-600":r.eliminated})},[e("td",Re,u(r.user),1),e("td",je,u(r.game),1),e("td",Oe,u(r.picked?"Yes":"No"),1),e("td",He,u(r.eliminated?"Yes":"No"),1)],2))),128))])])]),e("div",De,[e("button",{onClick:a[2]||(a[2]=(...r)=>c.pickWinner&&c.pickWinner(...r)),class:"btn-primary",disabled:d.loading},[d.loading?(i(),n("span",qe,"Loading...")):(i(),n("span",Ye,"Alege Câștigător"))],8,Je),e("button",{onClick:a[3]||(a[3]=(...r)=>c.fillList&&c.fillList(...r)),class:"btn-primary",disabled:d.loading},[d.loading?(i(),n("span",Ze,"Loading...")):(i(),n("span",Ke,"Umple Lista"))],8,Ie),e("button",{onClick:a[4]||(a[4]=(...r)=>c.clearList&&c.clearList(...r)),class:"btn-danger",disabled:d.loading},[d.loading?(i(),n("span",Xe,"Loading...")):(i(),n("span",et,"Șterge Lista"))],8,Qe)]),a[9]||(a[9]=e("p",{class:"mb-2 text-gray-300 text-sm"}," Poți automatiza procesul de înscriere dacă folosești Streamlabs Cloud Bot. ",-1)),a[10]||(a[10]=e("p",{class:"mb-2 text-gray-300 text-sm"}," Creează comanda Streamlabs Coud Bot !particip: ",-1)),e("div",tt,[e("button",{class:"w-full text-left p-2 bg-green-600 text-gray-900 rounded focus:outline-none hover:bg-green-500 transition",onClick:a[5]||(a[5]=r=>c.copyText(c.apiUrlCommand))},[e("code",null,u(c.apiUrlCommand),1)])]),a[11]||(a[11]=e("p",{class:"mb-2 text-gray-300 text-sm"}," Creează comanda NightBot !particip: ",-1)),e("div",st,[e("button",{class:"w-full text-left p-2 bg-green-600 text-gray-900 rounded focus:outline-none hover:bg-green-500 transition",onClick:a[6]||(a[6]=r=>c.copyText(c.apiUrlCommandNightBot))},[e("code",null,u(c.apiUrlCommandNightBot),1)])])])}const lt=fe(_e,[["render",at],["__scopeId","data-v-93235c65"]]);const ot={class:"py-4"},it={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},nt={key:0,class:"bg-gray-800 overflow-hidden shadow-lg rounded-md transition-all duration-300"},rt={class:"p-6 space-y-4"},dt={class:"flex flex-row gap-2"},ut={class:"flex flex-col md:flex-row md:space-x-4"},ct={class:"md:w-2/3 bg-gray-800 p-6 rounded-md shadow-md space-y-4 transition-all duration-300"},mt={class:"text-lg font-semibold text-gray-300 flex gap-2 items-center"},pt={class:"flex gap-4"},gt={key:0,class:"absolute inset-0 pointer-events-none bg-blur transition-all duration-300"},bt={class:"relative z-10 flex items-center gap-4 w-full"},yt=["src"],ht=["onUpdate:modelValue"],ft=["disabled"],vt={key:1,class:"bg-gray-900 overflow-hidden shadow-lg rounded-md transition-all duration-300"},_t={class:"p-6 flex justify-center items-center bg-gray-800"},xt={class:"w-full max-w-md bg-gray-900 shadow-lg rounded-md p-6 text-center transition-all duration-300"},wt=["src"],kt={class:"text-2xl font-bold text-gray-100 mb-2"},Ct={class:"text-lg font-medium text-gray-300"},Bt={key:2,class:"bg-gray-900 overflow-hidden shadow-lg rounded-md mt-6 transition-all duration-300"},Vt={class:"p-6"},$t={class:"flex justify-between items-center"},Ut={class:"text-xl font-bold mb-4 text-gray-100"},St={class:"text-gray-300"},At={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4"},Ft={key:0,class:"absolute inset-0 pointer-events-none bg-blur transition-all duration-300"},Tt={class:"flex gap-2 items-center mb-2 p-2 rounded-md border border-gray-600 transition-all duration-300"},Et=["src"],Nt={class:"w-full"},Lt={class:"text-lg font-bold mb-2 text-gray-100"},zt={class:"flex flex-row gap-2"},Wt={class:"text-sm font-medium text-gray-300"},Pt=["onUpdate:modelValue","disabled","onInput"],Mt={class:"text-sm font-medium text-gray-300"},Gt=["disabled","onUpdate:modelValue","onInput"],Rt={class:"text-sm font-medium text-gray-300"},jt=["onUpdate:modelValue"],Ot=["onClick"],Ht=["disabled"],Dt={class:"mt-4 text-lg font-bold text-gray-100"},Jt={key:1,class:"mt-4"},qt={class:"text-lg font-bold text-gray-100"},Yt={class:"mt-6 flex flex-col gap-4"},It=["disabled"],Zt=["disabled"],Kt={class:"p-6"},Qt={key:0,class:"table-auto w-full text-sm text-gray-200 mb-2 transition-all duration-300"},Xt={class:"px-4 py-2 font-bold"},es={class:"px-4 py-2"},ts={key:1,class:"table-auto w-full text-sm text-gray-200 transition-all duration-300"},ss={class:"border border-black px-1 py-1 shrink w-0"},as={class:"border border-black px-2 py-1"},ls={class:"border border-black px-2 py-1"},cs={__name:"BonusBattle",setup(o){const a=g(!0),m=g(""),v=g("5-10"),d=g(""),c=g("2"),r=g([{game_id:null,for_user:null},{game_id:null,for_user:null},{game_id:null,for_user:null},{game_id:null,for_user:null}]),h=g(null),F=g(null),W=g(null),P=g(null),T=g([{}]),Y=g(null),E=g([]),M=g(!1),x=g(null),k=g([]);let R=g(!1);const I=he(),Z=J(()=>I.availableGames);let j=g(null);pe(async()=>{await B()});const K=J(()=>r.value.length<4?!0:r.value.some(l=>!l.game_id)),G=J(()=>T.value?T.value.length<2?!1:T.value.every(l=>l.cost_buy>0):!1),se=()=>{R.value=!0},O=()=>{R.value=!1},H=l=>{r.value=Array.from({length:l},()=>({game_id:"",for_user:""}))},Q=async()=>{k.value.forEach(l=>{const t=(l==null?void 0:l.scores.length)>0?l.scores[l.scores.length-1].cost_buy:0;l==null||l.scores.push({bracket_id:P.value.id,bonus_concurrent_id:l.id,cost_buy:t,score:0,result_buy:0})}),await D(),await B()},ae=async(l,t)=>{await oe(k.value[l].scores[t].id),k.value[l].scores.splice(t,1),await B()},X=async(l,t)=>{j&&clearTimeout(j),j=setTimeout(async()=>{const s=k.value[l].scores[t];s.cost_buy>0?(s.score=parseFloat((s.result_buy/s.cost_buy).toFixed(3)),await D()):alert("Amount must be greater than 0.")},1e3)},le=l=>l.reduce((t,s)=>t+s.score,0).toFixed(3),oe=async l=>{var t;try{a.value=!0;const s=await axios.delete(`/api/bonus-battles/delete-score/${l}`);console.log("Bonus score deleted successfully:",s.data),await D()}catch(s){console.error("Failed to delete bonus score:",((t=s.response)==null?void 0:t.data)||s.message)}finally{a.value=!1}},D=async()=>{var l;try{a.value=!0;const t=await axios.post("/api/bonus-battles/add-score",{active_bracket:P.value.id,bracket:k.value});console.log("Bonus battle stored successfully:",t.data)}catch(t){console.error("Failed to store bonus score:",((l=t.response)==null?void 0:l.data)||t.message)}finally{a.value=!1}},ie=async()=>{var l;if(!m.value||r.value.some(t=>!t.game_id)){alert("All fields must be filled to start.");return}try{const t=await axios.post("/api/bonus-battles",{title:m.value,stake:v.value,prize:d.value,buys:c.value,concurrents:r.value});console.log("Bonus battle stored successfully:",t.data),await B()}catch(t){console.error("Failed to store bonus battle:",((l=t.response)==null?void 0:l.data)||t.message),alert("An error occurred while saving the bonus battle. Please try again.")}},ne=async()=>{var l;try{const t=await axios.post("/api/bonus-battles/end-battle",{bonus_battle_id:h.value.id});x.value=t.data.winner,await B()}catch(t){console.log("endBattle error:",((l=t.response)==null?void 0:l.data)||t.message)}},re=async()=>{var l;try{a.value=!0,await axios.post("/api/bonus-battles/end-battle-forced",{bonus_battle_id:h.value.id}),O()}catch(t){console.error("Failed to force close bonus battle:",((l=t.response)==null?void 0:l.data)||t.message),alert("A aparut o eroare la închiderea forțată a turneului. Te rugăm să în contactezi pe Mala!")}finally{await B(),a.value=!1}},de=async()=>{var l;try{a.value=!0,await axios.post("/api/bonus-battles/finish-round",{active_bracket:P.value.id}),await B()}catch(t){console.error("Failed to finish round:",((l=t.response)==null?void 0:l.data)||t.message),alert("An error occurred while finishing the round. Please try again.")}finally{a.value=!1}},ue=async(l,t)=>{try{a.value=!0,await axios.put("/api/bonus-battles/edit-concurrent",{id:l,game_id:t}),await B(),M.value=!1}catch{alert("Please try again.")}finally{a.value=!1}},B=async()=>{var l;try{a.value=!0;const t=await axios.get("/api/bonus-battles/active");if(Y.value=t.data.total_battles,h.value=t.data.battle,F.value=t.data.concurrents,W.value=t.data.stage,P.value=t.data.bracket,T.value=t.data.scores,E.value=t.data.history,m.value="Bonus Battle #"+(Y.value+1),F.value){const y=F.value;k.value=y.slice(0,2).map(p=>{const f=T.value.filter(w=>w.bonus_concurrent_id===p.id);return{...p,scores:f.length?f:[]}})}if(k.value.some(y=>y.scores.length===0)){const y=((l=h.value)==null?void 0:l.buys)||0;if(y>0)for(let p=0;p<y;p++)await Q()}}catch(t){console.error("Failed to fetch active bonus battle:",t.message)}finally{a.value=!1}},N=l=>{const t=I.availableGames.find(s=>s.id===l);return t?`/storage/games/${t.image}`:""},ce=l=>{console.log("Winners picked:",l),r.value=r.value.map((t,s)=>({...t,for_user:l[s]!==void 0?l[s]:""}))};return(l,t)=>a.value?b("",!0):(i(),ge(ye,{key:0,title:"Bonus Battle"},{default:L(()=>[e("div",ot,[e("div",it,[!h.value&&!x.value?(i(),n("div",nt,[e("div",rt,[e("div",dt,[e("div",null,[t[9]||(t[9]=e("label",{for:"title",class:"block text-sm font-medium text-gray-300"},"Titlu Bonus Battle",-1)),C(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>m.value=s),id:"title",class:"mt-1 block w-full input-primary"},null,512),[[V,m.value]])]),e("div",null,[t[10]||(t[10]=e("label",{for:"stake",class:"block text-sm font-medium text-gray-300"},"Miză (eg: 5-8, 5, 10-20, etc.)",-1)),C(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=s=>v.value=s),id:"stake",class:"mt-1 block w-full input-primary"},null,512),[[V,v.value]])]),e("div",null,[t[11]||(t[11]=e("label",{for:"prize",class:"block text-sm font-medium text-gray-300"},"Premiu",-1)),C(e("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=s=>d.value=s),id:"prize",class:"mt-1 block w-full input-primary"},null,512),[[V,d.value]])]),e("div",null,[t[12]||(t[12]=e("label",{for:"buys",class:"block text-sm font-medium text-gray-300"},"Câte buys per joc (poți face ulterior câte vrei)",-1)),C(e("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=s=>c.value=s),id:"buys",class:"mt-1 block w-full input-primary"},null,512),[[V,c.value]])])]),e("div",ut,[e("div",ct,[e("h3",mt,[t[13]||(t[13]=$(" Participanți ")),e("div",pt,[e("button",{onClick:t[4]||(t[4]=s=>H(4)),class:"btn-primary"},"4"),e("button",{onClick:t[5]||(t[5]=s=>H(8)),class:"btn-primary"},"8"),e("button",{onClick:t[6]||(t[6]=s=>H(16)),class:"btn-primary"},"16")])]),z(be,{name:"fade"},{default:L(()=>[(i(!0),n(U,null,S(r.value,(s,y)=>(i(),n("div",{key:y,class:"relative overflow-hidden flex items-center gap-4 bg-gray-900 p-4 rounded-md shadow transition-all duration-300",style:ee(s.game_id?{"--bg-image":"url("+N(s.game_id)+")"}:{})},[s.game_id?(i(),n("div",gt)):b("",!0),e("div",bt,[s.game_id?(i(),n("img",{key:0,src:N(s.game_id),alt:"Game Thumbnail",class:"w-16 h-16 object-cover rounded-md"},null,8,yt)):b("",!0),z(q(te),{options:Z.value,label:"name",reduce:p=>p.id,modelValue:s.game_id,"onUpdate:modelValue":p=>s.game_id=p,placeholder:"Alege Joc",class:"flex-1 transition-all duration-300","append-to-body":""},null,8,["options","reduce","modelValue","onUpdate:modelValue"]),C(e("input",{type:"text","onUpdate:modelValue":p=>s.for_user=p,class:"flex-1 input-primary",placeholder:"Cine a ales? (opțional)"},null,8,ht),[[V,s.for_user]])])],4))),128))]),_:1})]),z(lt,{onWinnersPicked:ce,fillCount:r.value.length},null,8,["fillCount"])]),e("button",{disabled:K.value,class:_([{"opacity-50 cursor-not-allowed":K.value},"mt-4 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md transition-all duration-300"]),type:"button",onClick:ie}," Start ",10,ft)])])):b("",!0),x.value&&!h.value?(i(),n("div",vt,[e("div",_t,[e("div",xt,[x.value.game.image?(i(),n("img",{key:0,src:N(x.value.game.id),alt:"Game Thumbnail",class:"w-32 mx-auto object-cover rounded-md mb-4"},null,8,wt)):b("",!0),e("h2",kt," Câștigător! - "+u(x.value.game.name),1),e("p",Ct," User: "+u(x.value.for_user),1)])])])):b("",!0),z(ve,{show:q(R),onClose:O},{title:L(()=>t[14]||(t[14]=[$(" Log Out Other Browser Sessions ")])),content:L(()=>t[15]||(t[15]=[$(" Please enter your password to confirm you would like to log out of your other browser sessions across all of your devices. ")])),footer:L(()=>[e("button",{onClick:O,class:"btn-danger"}," ANULEAZĂ "),e("button",{class:"ml-3 btn-primary",onClick:re}," ÎNCHIDE FORȚAT ACEST BONUS BATTLE ")]),_:1},8,["show"]),h.value?(i(),n("div",Bt,[e("div",Vt,[e("div",$t,[e("h2",Ut,"Active Battle: "+u(h.value.title),1),e("button",{class:"btn-danger",onClick:se}," INCHIDE TURNEU FORȚAT ")]),e("p",St," Miza: "+u(h.value.stake)+" | Etapa: "+u(W.value.name)+" | Premiu: "+u(h.value.prize)+" | Buys: "+u(h.value.buys),1),k.value.length>1?(i(),n("div",At,[(i(!0),n(U,null,S(k.value,(s,y)=>(i(),n("div",{key:y,class:_(["relative border rounded-md p-4 shadow transition-all duration-300 game-active-row",s.game.image?"bg-transparent":"bg-gray-900"]),style:ee(s.game.image?{"--bg-image":"url("+N(s.game.id)+")"}:{})},[s.game.image?(i(),n("div",Ft)):b("",!0),e("div",{class:_(["relative z-10 p-4",s.game.image?"bg-black bg-opacity-60":"bg-gray-900"])},[e("div",Tt,[s.game.image?(i(),n("img",{key:0,src:N(s.game.id),alt:"Game Thumbnail",class:"w-auto h-[100px] rounded-md"},null,8,Et)):b("",!0),e("div",Nt,[e("h3",Lt,u(s.game.name)+" - "+u(s.for_user),1),e("div",zt,[z(q(te),{disabled:!M.value,options:Z.value,label:"name",reduce:p=>p.id,"onUpdate:modelValue":p=>ue(s.id,p),placeholder:"Schimbi jocul?",class:"flex-1 transition-all duration-300","append-to-body":""},null,8,["disabled","options","reduce","onUpdate:modelValue"]),e("button",{class:"btn-secondary transition-all duration-300",onClick:t[7]||(t[7]=p=>M.value=!M.value)}," SCHIMBA JOCU ")])])]),e("div",null,[(i(!0),n(U,null,S(s.scores,(p,f)=>(i(),n("div",{key:f,class:"flex items-center space-x-2 mt-1 transition-all duration-300"},[e("label",Wt,[t[16]||(t[16]=$(" Cost Buy ")),C(e("input",{type:"number","onUpdate:modelValue":w=>s.scores[f].cost_buy=w,class:_(["block w-40 border border-gray-600 rounded-md shadow-sm p-2 transition-all duration-300 input-primary",{"input-disabled":a.value}]),disabled:a.value,placeholder:"Amount",onInput:w=>X(y,f)},null,42,Pt),[[V,s.scores[f].cost_buy]])]),e("label",Mt,[t[17]||(t[17]=$(" Rezultat Buy ")),C(e("input",{disabled:p.cost_buy<=0||a.value,class:_([{"input-disabled":p.cost_buy<=0||a.value,"input-primary":p.cost_buy>0},"block w-40 border border-gray-600 rounded-md shadow-sm p-2 transition-all duration-300"]),type:"number","onUpdate:modelValue":w=>s.scores[f].result_buy=w,placeholder:"Result",onInput:w=>X(y,f)},null,42,Gt),[[V,s.scores[f].result_buy]])]),e("label",Rt,[t[18]||(t[18]=$(" Scor ")),C(e("input",{readonly:"",disabled:"",type:"number","onUpdate:modelValue":w=>s.scores[f].score=w,class:"block w-20 border border-gray-600 rounded-md shadow-sm p-2 input-disabled transition-all duration-300",placeholder:"Result"},null,8,jt),[[V,s.scores[f].score]])]),f>=1?(i(),n("button",{key:0,type:"button",onClick:w=>ae(y,f),class:"btn-danger transition-all duration-300 align-middle"},t[19]||(t[19]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1)]),8,Ot)):b("",!0)]))),128)),e("button",{type:"button",onClick:t[8]||(t[8]=p=>Q()),disabled:a.value,class:_([{"input-disabled":a.value},"btn-primary mt-2"])}," Adaugă Buy ",10,Ht)]),e("p",Dt," Scor Total: "+u(le(s.scores)),1)],2)],6))),128))])):b("",!0),x.value?(i(),n("div",Jt,[e("p",qt,"Câștigător: "+u(x.value.game.name)+" | User: "+u(x.value.for_user),1)])):b("",!0),e("div",Yt,[W.value.name!=="Final"?(i(),n("button",{key:0,type:"button",onClick:de,class:_(["bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md transition-all duration-300",{"input-disabled opacity-50":!G.value||a.value}]),disabled:!G.value||a.value}," Următoarii Concurenți ",10,It)):b("",!0),W.value.name==="Final"?(i(),n("button",{key:1,type:"button",onClick:ne,class:_(["bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md transition-all duration-300",{"input-disabled opacity-50":!G.value}]),disabled:!G.value}," Termina Battle ",10,Zt)):b("",!0)])]),e("div",Kt,[E.value.stage_brackets.length>0?(i(),n("table",Qt,[e("tbody",null,[(i(!0),n(U,null,S(E.value.stage_brackets,(s,y)=>(i(),n("tr",{key:s.id,class:_(y%2===0?"bg-gray-900":"bg-gray-800")},[e("td",Xt,[e("span",{class:_({"line-through text-gray-500":s.winner!==s.participant_a})},u(s.participant_a),3),t[20]||(t[20]=$(" vs ")),e("span",{class:_({"line-through text-gray-500":s.winner!==s.participant_b})},u(s.participant_b),3)]),e("td",es,u(parseFloat(s.participant_a_score).toFixed(3))+" - "+u(parseFloat(s.participant_b_score).toFixed(3)),1)],2))),128))])])):b("",!0),E.value.concurrents.length>0?(i(),n("table",ts,[e("tbody",null,[(i(!0),n(U,null,S(E.value.concurrents,(s,y)=>(i(),n("tr",{key:s==null?void 0:s.id,class:_(y%2===0?"bg-gray-900":"bg-gray-800")},[e("td",ss,u(s!=null&&s.is_eliminated?"❌":"✅"),1),e("td",as,u((s==null?void 0:s.game.name)||"N/A"),1),e("td",ls,u((s==null?void 0:s.for_user)||"N/A"),1)],2))),128))])])):b("",!0)])])):b("",!0)])])]),_:1}))}};export{cs as default};
