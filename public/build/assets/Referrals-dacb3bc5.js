import{c as l,b as e,t as d,h as c,L as f,F as m,E as _,o as a,k as g,d as y}from"./app-45f49d1d.js";import{_ as b}from"./_plugin-vue_export-helper-c27b6911.js";const x={props:{streamerId:{type:Number,required:!0}},data(){return{list:[],topReferrers:[],filteredList:[],user:"",filter:{from:"",to:""}}},async mounted(){await this.getReferrals()},methods:{async getReferrals(){try{const r=await axios.get(`/api/viewer/get-referrals/${this.streamerId}`);this.list=r.data.list,this.user=r.data.user,this.filteredList=this.list,this.calculateTopReferrers()}catch(r){console.log(r)}},calculateTopReferrers(){const r=this.list.reduce((t,o)=>(t[o.parent_user]=(t[o.parent_user]||0)+1,t),{});this.topReferrers=Object.entries(r).map(([t,o])=>({parent_user:t,count:o})).sort((t,o)=>o.count-t.count)},filterReferrals(){const r=new Date(this.filter.from),t=new Date(this.filter.to);this.filteredList=this.list.filter(o=>{const i=o.created_at?new Date(o.created_at):null;return(!r||!i||i>=r)&&(!t||!i||i<=t)})}}},h={class:"py-2 text-gray-200 min-h-screen"},w={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},v={class:"rounded-lg backdrop-blur-xl p-4 bg-white/10 shadow-lg shadow-black/40 border border-white/20"},R={class:"flex justify-between items-center mb-6"},k={class:"text-3xl font-bold"},D={class:"flex space-x-4 items-center"},L={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},N={class:"bg-gray-900 p-4 rounded-lg shadow"},T={key:0},V={key:1},A={key:2},C={class:"bg-gray-800 p-4 rounded-lg shadow"},F={class:"w-full text-left text-sm"},U={class:"px-4 py-2"},j={class:"px-4 py-2"},B={class:"px-4 py-2"};function I(r,t,o,i,n,u){return a(),l("div",h,[e("div",w,[e("div",v,[e("div",R,[e("h1",k,"Referrals pentru "+d(n.user),1),e("div",D,[t[3]||(t[3]=e("label",{for:"fromDate",class:"text-sm font-medium"},"From:",-1)),c(e("input",{id:"fromDate",type:"date","onUpdate:modelValue":t[0]||(t[0]=s=>n.filter.from=s),class:"bg-gray-700 text-gray-200 px-3 py-1 rounded-md border border-gray-600"},null,512),[[f,n.filter.from]]),t[4]||(t[4]=e("label",{for:"toDate",class:"text-sm font-medium"},"To:",-1)),c(e("input",{id:"toDate",type:"date","onUpdate:modelValue":t[1]||(t[1]=s=>n.filter.to=s),class:"bg-gray-700 text-gray-200 px-3 py-1 rounded-md border border-gray-600"},null,512),[[f,n.filter.to]]),e("button",{onClick:t[2]||(t[2]=(...s)=>u.filterReferrals&&u.filterReferrals(...s)),class:"btn-primary"}," Filter ")])]),e("div",L,[e("div",N,[t[5]||(t[5]=e("h2",{class:"text-xl font-bold mb-4"},"Leaderboard",-1)),e("ul",null,[(a(!0),l(m,null,_(n.topReferrers,(s,p)=>(a(),l("li",{key:s.parent_user,class:"flex justify-between items-center p-2 rounded-md hover:bg-gray-600"},[e("span",null,[p===0?(a(),l("span",T,"ðŸ¥‡")):p===1?(a(),l("span",V,"ðŸ¥ˆ")):p===2?(a(),l("span",A,"ðŸ¥‰")):g("",!0),y(" "+d(s.parent_user),1)]),e("span",null,d(s.count)+" Referrals",1)]))),128))])]),e("div",C,[t[7]||(t[7]=e("h2",{class:"text-xl font-bold mb-4"},"All Referrals",-1)),e("table",F,[t[6]||(t[6]=e("thead",{class:"bg-gray-800 text-gray-300"},[e("tr",null,[e("th",{class:"px-4 py-2"},"Parent User"),e("th",{class:"px-4 py-2"},"Referred User"),e("th",{class:"px-4 py-2"},"Created At")])],-1)),e("tbody",null,[(a(!0),l(m,null,_(n.filteredList,s=>(a(),l("tr",{key:s.id,class:"hover:bg-gray-600"},[e("td",U,d(s.parent_user),1),e("td",j,d(s.referred_user),1),e("td",B,d(s.created_at?new Date(s.created_at).toLocaleDateString():"N/A"),1)]))),128))])])])])])])])}const q=b(x,[["render",I],["__scopeId","data-v-a61774b6"]]);export{q as default};
