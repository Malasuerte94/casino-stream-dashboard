import{S as v}from"./SvgBh-938ea520.js";import{_ as f}from"./_plugin-vue_export-helper-c27b6911.js";import{N as L,e as o,a as t,b,t as i,g as p,O as y,F as _,h as m,f as G,o as u,n as g}from"./app-5756ac96.js";const S={components:{SvgBh:v},props:["id"],data(){return{loading:!0,bonusList:[],bonusListGames:[],settings:null,isUpdating:!1,scrollSpeed:500,itWasDuplicated:!0}},computed:{startAmount(){return this.bonusList.start??0},huntOrBuy(){var s;return((s=this.settings)==null?void 0:s.bonus_list)==="buy"?"Buy":"Hunt"},duplicatedGames(){return this.shouldScroll()?(this.itWasDuplicated=!0,[...this.bonusListGames,...this.bonusListGames]):(this.itWasDuplicated=!1,this.bonusListGames)},firstEmptyResultId(){const s=this.bonusListGames.find(l=>l.result==="0");return s?s.id:null},gamesOpenedNr(){return this.bonusListGames.filter(s=>s.result&&s.result!=="0").length},gamesTotalNr(){return this.bonusListGames.length},gamesRemainingNr(){return this.bonusListGames.filter(s=>!s.result||s.result==="0").length},gameHighestMulti(){const s=this.bonusListGames.map(l=>l!=null&&l.multiplier?parseFloat(l.multiplier.trim()):NaN).filter(l=>!isNaN(l));return s.length?Math.max(...s):0},progressPercentage(){return this.gamesOpenedNr/this.gamesTotalNr*100},averageMulti(){const s=this.bonusListGames.filter(a=>a.result!==null&&a.result!=="0");if(s.length===0)return 0;const l=s.reduce((a,d)=>a+parseFloat(d.multiplier),0);return Math.round(l/s.length)}},async mounted(){await this.getSettings(),await this.getLatestList(),this.loading=!1,await this.$nextTick(()=>{this.initAutoScroll(this.$refs.scrollWrapper),this.initAutoScroll(this.$refs.scrollWrapperHunt)}),await this.updateTheListFromTimeToTime()},methods:{shouldScroll(){const s=this.$refs.scrollWrapper||this.$refs.scrollWrapperHunt,l=this.$refs.viewport;if(!s||!l)return!1;const a=document.querySelector(".header-list"),d=a?a.getBoundingClientRect().height:0,n=l.getBoundingClientRect().bottom-d,h=s.querySelectorAll(".game-single");if(h.length===0)return!1;let e=0;return h.forEach(r=>{e+=r.getBoundingClientRect().height}),this.itWasDuplicated&&(e=e/2),e+20>n},async getSettings(){await axios.get("/api/settings/"+this.id).then(s=>{this.settings=s.data.settings}).catch(s=>{console.log(s)})},async getLatestList(){await axios.get("/api/bonus-list/"+this.id).then(s=>{this.bonusList=s.data.bonusList,this.bonusListGames=s.data.bonusListGames}).catch(s=>{console.log(s)})},async updateTheListFromTimeToTime(){setInterval(async()=>{this.isUpdating||(this.isUpdating=!0,await this.getLatestList(),this.isUpdating=!1,this.initAutoScroll())},8e3)},initAutoScroll(){const s=this.$refs.gamesList||this.$refs.gamesListHunt;s&&(this.shouldScroll()?s.classList.add("scrolling"):s.classList.remove("scrolling"))}}},w={key:0,class:"table",ref:"viewport"},B={class:"table-container"},N={class:"header-list"},T={class:"header-list-title"},x={class:"img-list"},k=t("span",null,"Bonus",-1),H={class:"bonus-details"},M={class:"list-cost"},R={class:"list-opened"},W={class:"details"},A={class:"details"},C={class:"progress"},O={class:"header-details"},F=t("div",{class:"header"},[t("div",{class:"header-content_buy header-content"},[t("div",{class:"text-center"},"#"),t("div",null,"Joc"),t("div",null,"Miză"),t("div",null,"Preț"),t("div",null,"Plată"),t("div",null,"Multi")])],-1),z={class:"scroll-wrapper",ref:"scrollWrapper"},D={class:"games",ref:"gamesList"},E={class:"number_game"},I={class:"name_game"},P={class:"stake"},U=t("div",{class:"header"},[t("div",{class:"header-content_hunt header-content"},[t("div",{class:"text-center"},"#"),t("div",null,"Joc"),t("div",null,"Miză"),t("div",null,"Plată"),t("div",null,"Multi")])],-1),V={class:"scroll-wrapper",ref:"scrollWrapperHunt"},q={class:"games",ref:"gamesListHunt"},J={class:"number_game"},j={class:"name_game"},K={class:"stake"};function Q(s,l,a,d,c,n){const h=L("SvgBh");return c.loading?G("",!0):(u(),o("div",w,[t("div",B,[t("div",N,[t("div",T,[t("span",x,[b(h)]),k,t("span",null,i(n.huntOrBuy),1),t("div",H,[t("div",M,[p("Cost "),t("span",null,i(n.startAmount)+" lei",1)]),t("div",R,[t("div",W,[t("span",null,i(n.gamesOpenedNr)+"/",1)]),t("div",A,[t("span",null,i(n.gamesTotalNr),1)])])])]),t("div",C,[t("div",{class:"progress-bar-fill",style:y({width:n.progressPercentage+"%"})},null,4)]),t("div",O,[t("div",null,[p("Avg (x)"),t("span",null,i(n.averageMulti),1)]),t("div",null,[p("Top (x)"),t("span",null,i(n.gameHighestMulti),1)]),t("div",null,[p("Rezultat"),t("span",null,i(c.bonusList.result)+" lei",1)])])]),n.huntOrBuy==="Buy"?(u(),o(_,{key:0},[F,t("div",z,[t("div",D,[(u(!0),o(_,null,m(n.duplicatedGames,(e,r)=>(u(),o("div",{key:"a-"+r,class:g(["game-single row-game_buy",{current:n.firstEmptyResultId===e.id}])},[t("div",E,i(r%c.bonusListGames.length+1),1),t("div",I,i(e.name),1),t("div",P,i(e.stake),1),t("div",null,i(e.result==="0"||e.result==null?"":e.result),1),t("div",null,i(e.multiplier==="0"||e.multiplier==null?"":"x"+e.multiplier),1)],2))),128))],512)],512)],64)):(u(),o(_,{key:1},[U,t("div",V,[t("div",q,[(u(!0),o(_,null,m(n.duplicatedGames,(e,r)=>(u(),o("div",{key:"b-"+r,class:g(["game-single row-game_hunt",{current:n.firstEmptyResultId===e.id}])},[t("div",J,i(r%c.bonusListGames.length+1),1),t("div",j,i(e.name),1),t("div",K,i(e.stake),1),t("div",null,i(e.result==="0"||e.result==null?"":e.result),1),t("div",null,i(e.multiplier==="0"||e.multiplier==null?"":"x"+e.multiplier),1)],2))),128))],512)],512)],64))])],512))}const $=f(S,[["render",Q]]);export{$ as default};
