import{q as E,o as i,c as n,b as e,h as B,m as pe,d as S,t as c,k as y,F as U,C as A,n as _,D as ge,i as b,l as j,j as be,f as ye,w as z,E as $,a as L,G as te,u as Y,H as he}from"./app-d8c6f556.js";import{_ as fe}from"./AppLayout-dcb9fb70.js";import{u as ve,C as se}from"./gameStore-c3a2f361.js";import{_ as _e}from"./_plugin-vue_export-helper-c27b6911.js";import{_ as xe}from"./DialogModal-c93989d8.js";import"./ResponsiveNavLink-3bd70657.js";const we={name:"BattleViewerList",emits:["winnersPicked"],data(){return{battleViewers:[],winners:[],setting:!1,loading:!1}},props:{fillCount:{type:Number,required:!1}},async mounted(){await this.fetchBattleViewers(),await this.fetchSetting(),window.Echo.channel(`App.Models.User.${this.$page.props.user.id}`).listen("BattleViewerUpdated",()=>{this.fetchBattleViewers()})},methods:{async fetchBattleViewers(){try{const a=await E.get("api/bonus-battles/battle-viewers");this.battleViewers=a.data}catch(a){console.error("Failed to fetch battle viewers:",a.message)}},async fetchSetting(){if(!this.loading){this.loading=!0;try{const a=await E.get("/api/get-setting-public",{params:{setting_name:"battle_selections"}});a.data.setting_value!==void 0&&(this.setting=a.data.setting_value==1),console.log(this.setting)}catch(a){console.error("Failed to fetch setting:",a.message)}finally{this.loading=!1}}},copyText(a){if(navigator.clipboard)navigator.clipboard.writeText(a).then(()=>{alert("Comanda a fost copiată în clipboard")}).catch(l=>{console.error("Failed to copy text: ",l)});else{const l=document.createElement("input");l.value=a,document.body.appendChild(l),l.select();try{document.execCommand("copy"),console.log("Copied to clipboard")}catch(r){console.error("Failed to copy text: ",r)}document.body.removeChild(l)}},updateWinners(){this.$emit("winnersPicked",this.winners.map(a=>a.user))},getRandomItem(a){return a[Math.floor(Math.random()*a.length)]},async markAsPicked(a){try{await E.patch(`api/bonus-battles/battle-viewers/${a}`,{picked:!0})}catch(l){console.error("Failed to mark as picked:",l.message)}},async markAsEliminated(a){try{await E.patch(`api/bonus-battles/battle-viewers/${a}`,{eliminated:!0})}catch(l){console.error("Failed to mark as eliminated:",l.message)}},async pickWinner(){if(!this.loading){this.loading=!0;try{const a=this.battleViewers.filter(r=>!r.picked&&!r.eliminated);if(!a.length){console.error("No available candidates");return}const l=this.getRandomItem(a);await this.markAsPicked(l.id),l.picked=!0,this.winners.push(l),this.updateWinners()}catch(a){console.error("Error picking winner:",a)}finally{this.loading=!1}}},async fillList(){if(!this.loading){this.loading=!0;try{if(this.fillCount<0)return;const a=[];for(let l=0;l<this.fillCount;l++){const r=this.battleViewers.filter(u=>!u.picked&&!u.eliminated);if(!r.length)break;const h=this.getRandomItem(r);await this.markAsPicked(h.id),h.picked=!0,a.push(h)}this.winners=a,this.updateWinners()}catch(a){console.error("Error filling list:",a)}finally{this.loading=!1}}},clearList(){this.$dialog({message:"Ești sigur că vrei să faci o listă nouă?",buttons:["da","nu"],da:async()=>{if(!this.loading){this.loading=!0;try{await E.post("api/bonus-battles/battle-viewers/remove-all"),this.battleViewers=[],this.winners=[],this.updateWinners()}catch(a){console.error("Failed to clear the list:",a.message)}finally{this.loading=!1}}},nu:()=>console.log("Canceled reset")})},async rerollWinner(a,l){if(!this.loading){this.loading=!0;try{await this.markAsEliminated(a.id);const r=this.battleViewers.find(m=>m.id===a.id);r&&(r.eliminated=!0);const h=this.battleViewers.filter(m=>!m.picked&&!m.eliminated);if(!h.length){console.error("No available candidates for reroll");return}const u=this.getRandomItem(h);await this.markAsPicked(u.id),u.picked=!0,this.winners.splice(l,1,u),this.updateWinners()}catch(r){console.error("Error in rerollWinner:",r)}finally{this.loading=!1}}},eliminateWinner(a,l){this.$dialog({message:"Ești sigur că vrei să elimini acest utilizator?",buttons:["da","nu"],da:async()=>{if(!this.loading){this.loading=!0;try{await this.markAsEliminated(a.id),this.winners.splice(l,1);const r=this.battleViewers.find(h=>h.id===a.id);r&&(r.eliminated=!0),this.updateWinners()}catch(r){console.error("Error eliminating winner:",r)}finally{this.loading=!1}}},nu:()=>console.log("Canceled elimination")})},async updateSetting(){if(!this.loading){this.loading=!0;try{await E.post("/api/settings/save",{setting_name:"battle_selections",setting_value:this.setting})}catch(a){console.error("Error saving settings:",a)}finally{this.loading=!1}}}},computed:{apiUrlCommand(){return`{readapi.${window.location.origin}/api/add-bb-viewer/{user.name}/{1}/${this.$page.props.user.id}}`},apiUrlCommandNightBot(){return`$(urlfetch ${window.location.origin}/api/add-bb-viewer/$(user)/$(1) $(2) $(3)/${this.$page.props.user.id})`}}},ke={class:"p-2 rounded-md shadow-md md:w-1/3 bg-gray-800 space-y-4 transition-all duration-300"},Ce={class:"flex items-center justify-between p-2 bg-gray-700 rounded"},Be={for:"toggle",class:"relative inline-flex items-center cursor-pointer"},Ve=["disabled"],$e={class:"ml-3 text-sm font-medium text-gray-300"},Se={key:0,class:"ml-2 text-xs italic text-gray-400"},Ue={key:0,class:"overflow-auto max-h-60 border border-gray-700 rounded"},Ae={class:"min-w-full text-sm"},Ee={class:"text-sm"},Fe={class:"px-2 py-2"},Te={class:"px-2 py-2"},Ne={class:"px-2 py-2"},ze=["onClick","disabled"],Le={key:0},We={key:1},Pe=["onClick","disabled"],Ge={key:0},Me={key:1},Re={class:"overflow-auto max-h-60 border border-gray-700 rounded"},je={class:"min-w-full"},He={class:"px-2 py-2"},De={class:"px-2 py-2"},Oe={class:"px-2 py-2"},Je={class:"px-2 py-2"},qe={class:"mt-4 flex space-x-4"},Ye=["disabled"],Ie={key:0},Ze={key:1},Ke=["disabled"],Qe={key:0},Xe={key:1},et=["disabled"],tt={key:0},st={key:1},at={class:"mb-4 text-sm"},lt={class:"mb-4 text-sm"};function ot(a,l,r,h,u,m){return i(),n("div",ke,[e("div",Ce,[e("label",Be,[B(e("input",{type:"checkbox",id:"toggle","onUpdate:modelValue":l[0]||(l[0]=d=>u.setting=d),onChange:l[1]||(l[1]=(...d)=>m.updateSetting&&m.updateSetting(...d)),class:"sr-only peer",disabled:u.loading},null,40,Ve),[[pe,u.setting]]),l[7]||(l[7]=e("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 rounded-full dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"},null,-1)),e("span",$e,[S(c(u.setting?"Înscrieri Pornite prin Bot":"Înscrieri Oprite prin Bot")+" ",1),u.loading?(i(),n("span",Se,"Loading...")):y("",!0)])])]),u.winners.length?(i(),n("div",Ue,[e("table",Ae,[e("tbody",Ee,[(i(!0),n(U,null,A(u.winners,(d,x)=>(i(),n("tr",{key:d.id,class:"text-sm"},[e("td",Fe,c(d.user),1),e("td",Te,c(d.game),1),e("td",Ne,[e("button",{onClick:v=>m.rerollWinner(d,x),class:"bg-blue-600 rounded p-1 btn-sm text-sm mr-2",disabled:u.loading},[u.loading?(i(),n("span",Le,"Loading...")):(i(),n("span",We,"Reroll"))],8,ze),e("button",{onClick:v=>m.eliminateWinner(d,x),class:"bg-red-600 rounded p-1 btn-sm",disabled:u.loading},[u.loading?(i(),n("span",Ge,"Loading...")):(i(),n("span",Me,"Elimină"))],8,Pe)])]))),128))])])])):y("",!0),e("div",Re,[e("table",je,[l[8]||(l[8]=e("thead",{class:"bg-gray-900"},[e("tr",null,[e("th",{class:"px-2 py-2 text-left text-gray-300"},"User"),e("th",{class:"px-2 py-2 text-left text-gray-300"},"Joc"),e("th",{class:"px-2 py-2 text-left text-gray-300"},"Ales"),e("th",{class:"px-2 py-2 text-left text-gray-300"},"Eliminat")])],-1)),e("tbody",null,[(i(!0),n(U,null,A(u.battleViewers,d=>(i(),n("tr",{key:d.id,class:_({"bg-green-600":d.picked&&!d.eliminated,"bg-red-600":d.eliminated})},[e("td",He,c(d.user),1),e("td",De,c(d.game),1),e("td",Oe,c(d.picked?"Yes":"No"),1),e("td",Je,c(d.eliminated?"Yes":"No"),1)],2))),128))])])]),e("div",qe,[e("button",{onClick:l[2]||(l[2]=(...d)=>m.pickWinner&&m.pickWinner(...d)),class:"btn-primary",disabled:u.loading},[u.loading?(i(),n("span",Ie,"Loading...")):(i(),n("span",Ze,"Alege Câștigător"))],8,Ye),e("button",{onClick:l[3]||(l[3]=(...d)=>m.fillList&&m.fillList(...d)),class:"btn-primary",disabled:u.loading},[u.loading?(i(),n("span",Qe,"Loading...")):(i(),n("span",Xe,"Umple Lista"))],8,Ke),e("button",{onClick:l[4]||(l[4]=(...d)=>m.clearList&&m.clearList(...d)),class:"btn-danger",disabled:u.loading},[u.loading?(i(),n("span",tt,"Loading...")):(i(),n("span",st,"Șterge Lista"))],8,et)]),l[9]||(l[9]=e("p",{class:"mb-2 text-gray-300 text-sm"}," Poți automatiza procesul de înscriere dacă folosești Streamlabs Cloud Bot. ",-1)),l[10]||(l[10]=e("p",{class:"mb-2 text-gray-300 text-sm"}," Creează comanda Streamlabs Coud Bot !particip: ",-1)),e("div",at,[e("button",{class:"w-full text-left p-2 bg-green-600 text-gray-900 rounded focus:outline-none hover:bg-green-500 transition",onClick:l[5]||(l[5]=d=>m.copyText(m.apiUrlCommand))},[e("code",null,c(m.apiUrlCommand),1)])]),l[11]||(l[11]=e("p",{class:"mb-2 text-gray-300 text-sm"}," Creează comanda NightBot !particip: ",-1)),e("div",lt,[e("button",{class:"w-full text-left p-2 bg-green-600 text-gray-900 rounded focus:outline-none hover:bg-green-500 transition",onClick:l[6]||(l[6]=d=>m.copyText(m.apiUrlCommandNightBot))},[e("code",null,c(m.apiUrlCommandNightBot),1)])])])}const it=_e(we,[["render",ot],["__scopeId","data-v-93235c65"]]),nt=ge("battle",{state:()=>({concurrents:[{game_id:null,for_user:null},{game_id:null,for_user:null},{game_id:null,for_user:null},{game_id:null,for_user:null}]}),actions:{setConcurrents(a){this.concurrents=a},addConcurrent(a){this.concurrents=Array.from({length:a},()=>({game_id:"",for_user:""}))},updateConcurrent(a,l){this.concurrents[a]={...this.concurrents[a],...l}}},persist:!0});const rt={class:"py-4"},dt={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},ut={key:0,class:"bg-gray-800 overflow-hidden shadow-lg rounded-md transition-all duration-300"},ct={class:"p-6 space-y-4"},mt={class:"flex flex-row gap-2"},pt={class:"flex flex-col md:flex-row md:space-x-4"},gt={class:"md:w-2/3 bg-gray-800 p-6 rounded-md shadow-md space-y-4 transition-all duration-300"},bt={class:"text-lg font-semibold text-gray-300 flex gap-2 items-center"},yt={class:"flex gap-4"},ht={key:0,class:"absolute inset-0 pointer-events-none bg-blur transition-all duration-300"},ft={class:"relative z-10 flex items-center gap-4 w-full"},vt=["src"],_t=["onUpdate:modelValue"],xt=["disabled"],wt={key:1,class:"bg-gray-900 overflow-hidden shadow-lg rounded-md transition-all duration-300"},kt={class:"p-6 flex justify-center items-center bg-gray-800"},Ct={class:"w-full max-w-md bg-gray-900 shadow-lg rounded-md p-6 text-center transition-all duration-300"},Bt=["src"],Vt={class:"text-2xl font-bold text-gray-100 mb-2"},$t={class:"text-lg font-medium text-gray-300"},St={key:2,class:"bg-gray-900 overflow-hidden shadow-lg rounded-md mt-6 transition-all duration-300"},Ut={class:"p-6"},At={class:"flex justify-between items-center"},Et={class:"text-xl font-bold mb-4 text-gray-100"},Ft={class:"text-gray-300"},Tt={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4"},Nt={key:0,class:"absolute inset-0 pointer-events-none bg-blur transition-all duration-300"},zt={class:"flex gap-2 items-center mb-2 p-2 rounded-md border border-gray-600 transition-all duration-300"},Lt=["src"],Wt={class:"w-full"},Pt={class:"text-lg font-bold mb-2 text-gray-100"},Gt={class:"flex flex-row gap-2"},Mt={class:"text-sm font-medium text-gray-300"},Rt=["onUpdate:modelValue","disabled","onInput"],jt={class:"text-sm font-medium text-gray-300"},Ht=["disabled","onUpdate:modelValue","onInput"],Dt={class:"text-sm font-medium text-gray-300"},Ot=["onUpdate:modelValue"],Jt=["onClick"],qt=["disabled"],Yt={class:"mt-4 text-lg font-bold text-gray-100"},It={key:1,class:"mt-4"},Zt={class:"text-lg font-bold text-gray-100"},Kt={class:"mt-6 flex flex-col gap-4"},Qt=["disabled"],Xt=["disabled"],es={class:"p-6"},ts={key:0,class:"table-auto w-full text-sm text-gray-200 mb-2 transition-all duration-300"},ss={class:"px-4 py-2 font-bold"},as={class:"px-4 py-2"},ls={key:1,class:"table-auto w-full text-sm text-gray-200 transition-all duration-300"},os={class:"border border-black px-1 py-1 shrink w-0"},is={class:"border border-black px-2 py-1"},ns={class:"border border-black px-2 py-1"},gs={__name:"BonusBattle",setup(a){const l=nt(),r=b(!0),h=b(""),u=b("5-10"),m=b(""),d=b("2"),x=j(()=>l.concurrents),v=b(null),H=b(null),W=b(null),P=b(null),F=b([{}]),I=b(null),T=b([]),G=b(!1),w=b(null),C=b([]);let D=b(!1);const Z=ve(),K=j(()=>Z.availableGames);let O=b(null);be(async()=>{await V()});const Q=j(()=>x.value.length<4?!0:x.value.some(o=>!o.game_id)),M=j(()=>F.value?F.value.length<2?!1:F.value.every(o=>o.cost_buy>0):!1),ae=()=>{D.value=!0},J=()=>{D.value=!1},R=o=>{l.addConcurrent(o)},X=async()=>{C.value.forEach(o=>{const t=(o==null?void 0:o.scores.length)>0?o.scores[o.scores.length-1].cost_buy:0;o==null||o.scores.push({bracket_id:P.value.id,bonus_concurrent_id:o.id,cost_buy:t,score:0,result_buy:0})}),await q(),await V()},le=async(o,t)=>{await ie(C.value[o].scores[t].id),C.value[o].scores.splice(t,1),await V()},ee=async(o,t)=>{O&&clearTimeout(O),O=setTimeout(async()=>{const s=C.value[o].scores[t];s.cost_buy>0?(s.score=parseFloat((s.result_buy/s.cost_buy).toFixed(3)),await q()):alert("Amount must be greater than 0.")},1e3)},oe=o=>o.reduce((t,s)=>t+s.score,0).toFixed(3),ie=async o=>{var t;try{r.value=!0;const s=await axios.delete(`/api/bonus-battles/delete-score/${o}`);console.log("Bonus score deleted successfully:",s.data),await q()}catch(s){console.error("Failed to delete bonus score:",((t=s.response)==null?void 0:t.data)||s.message)}finally{r.value=!1}},q=async()=>{var o;try{r.value=!0;const t=await axios.post("/api/bonus-battles/add-score",{active_bracket:P.value.id,bracket:C.value});console.log("Bonus battle stored successfully:",t.data)}catch(t){console.error("Failed to store bonus score:",((o=t.response)==null?void 0:o.data)||t.message)}finally{r.value=!1}},ne=async()=>{var o;if(!h.value||x.value.some(t=>!t.game_id)){alert("All fields must be filled to start.");return}try{const t=await axios.post("/api/bonus-battles",{title:h.value,stake:u.value,prize:m.value,buys:d.value,concurrents:x.value});console.log("Bonus battle stored successfully:",t.data),await V()}catch(t){console.error("Failed to store bonus battle:",((o=t.response)==null?void 0:o.data)||t.message),alert("An error occurred while saving the bonus battle. Please try again.")}},re=async()=>{var o;try{const t=await axios.post("/api/bonus-battles/end-battle",{bonus_battle_id:v.value.id});w.value=t.data.winner,await V()}catch(t){console.log("endBattle error:",((o=t.response)==null?void 0:o.data)||t.message)}},de=async()=>{var o;try{r.value=!0,await axios.post("/api/bonus-battles/end-battle-forced",{bonus_battle_id:v.value.id}),J()}catch(t){console.error("Failed to force close bonus battle:",((o=t.response)==null?void 0:o.data)||t.message),alert("A aparut o eroare la închiderea forțată a turneului. Te rugăm să în contactezi pe Mala!")}finally{await V(),r.value=!1}},ue=async()=>{var o;try{r.value=!0,await axios.post("/api/bonus-battles/finish-round",{active_bracket:P.value.id}),await V()}catch(t){console.error("Failed to finish round:",((o=t.response)==null?void 0:o.data)||t.message),alert("An error occurred while finishing the round. Please try again.")}finally{r.value=!1}},ce=async(o,t)=>{try{r.value=!0,await axios.put("/api/bonus-battles/edit-concurrent",{id:o,game_id:t}),await V(),G.value=!1}catch{alert("Please try again.")}finally{r.value=!1}},V=async()=>{var o;try{r.value=!0;const t=await axios.get("/api/bonus-battles/active");if(I.value=t.data.total_battles,v.value=t.data.battle,H.value=t.data.concurrents,W.value=t.data.stage,P.value=t.data.bracket,F.value=t.data.scores,T.value=t.data.history,h.value="Bonus Battle #"+(I.value+1),H.value){const g=H.value;C.value=g.slice(0,2).map(p=>{const f=F.value.filter(k=>k.bonus_concurrent_id===p.id);return{...p,scores:f.length?f:[]}})}if(C.value.some(g=>g.scores.length===0)){const g=((o=v.value)==null?void 0:o.buys)||0;if(g>0)for(let p=0;p<g;p++)await X()}}catch(t){console.error("Failed to fetch active bonus battle:",t.message)}finally{r.value=!1}},N=o=>{const t=Z.availableGames.find(s=>s.id===o);return t?`/storage/games/${t.image}`:""},me=o=>{console.log("Winners picked:",o),x.value=x.value.map((t,s)=>({...t,for_user:o[s]!==void 0?o[s]:""}))};return(o,t)=>(i(),ye(fe,{title:"Bonus Battle"},{default:z(()=>[e("div",rt,[e("div",dt,[!v.value&&!w.value?(i(),n("div",ut,[e("div",ct,[e("div",mt,[e("div",null,[t[10]||(t[10]=e("label",{for:"title",class:"block text-sm font-medium text-gray-300"},"Titlu Bonus Battle",-1)),B(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>h.value=s),id:"title",class:"mt-1 block w-full input-primary"},null,512),[[$,h.value]])]),e("div",null,[t[11]||(t[11]=e("label",{for:"stake",class:"block text-sm font-medium text-gray-300"},"Miză (eg: 5-8, 5, 10-20, etc.)",-1)),B(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=s=>u.value=s),id:"stake",class:"mt-1 block w-full input-primary"},null,512),[[$,u.value]])]),e("div",null,[t[12]||(t[12]=e("label",{for:"prize",class:"block text-sm font-medium text-gray-300"},"Premiu",-1)),B(e("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=s=>m.value=s),id:"prize",class:"mt-1 block w-full input-primary"},null,512),[[$,m.value]])]),e("div",null,[t[13]||(t[13]=e("label",{for:"buys",class:"block text-sm font-medium text-gray-300"},"Câte buys per joc (poți face ulterior câte vrei)",-1)),B(e("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=s=>d.value=s),id:"buys",class:"mt-1 block w-full input-primary"},null,512),[[$,d.value]])])]),e("div",pt,[e("div",gt,[e("h3",bt,[t[14]||(t[14]=S(" Participanți ")),e("div",yt,[e("button",{onClick:t[4]||(t[4]=s=>R(4)),class:"btn-primary"},"4"),e("button",{onClick:t[5]||(t[5]=s=>R(8)),class:"btn-primary"},"8"),e("button",{onClick:t[6]||(t[6]=s=>R(16)),class:"btn-primary"},"16"),e("button",{onClick:t[7]||(t[7]=s=>R(4)),class:"btn-danger"},"RESET")])]),L(he,{name:"fade"},{default:z(()=>[(i(!0),n(U,null,A(x.value,(s,g)=>(i(),n("div",{key:g,class:"relative overflow-hidden flex items-center gap-4 bg-gray-900 p-4 rounded-md shadow transition-all duration-300",style:te(s.game_id?{"--bg-image":"url("+N(s.game_id)+")"}:{})},[s.game_id?(i(),n("div",ht)):y("",!0),e("div",ft,[s.game_id?(i(),n("img",{key:0,src:N(s.game_id),alt:"Game Thumbnail",class:"w-16 h-16 object-cover rounded-md"},null,8,vt)):y("",!0),L(Y(se),{options:K.value,label:"name",reduce:p=>p.id,modelValue:s.game_id,"onUpdate:modelValue":p=>s.game_id=p,placeholder:"Alege Joc",class:"flex-1 transition-all duration-300","append-to-body":""},null,8,["options","reduce","modelValue","onUpdate:modelValue"]),B(e("input",{type:"text","onUpdate:modelValue":p=>s.for_user=p,class:"flex-1 input-primary",placeholder:"Cine a ales? (opțional)"},null,8,_t),[[$,s.for_user]])])],4))),128))]),_:1})]),L(it,{onWinnersPicked:me,fillCount:x.value.length},null,8,["fillCount"])]),e("button",{disabled:Q.value,class:_([{"opacity-50 cursor-not-allowed":Q.value},"mt-4 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md transition-all duration-300"]),type:"button",onClick:ne}," Start ",10,xt)])])):y("",!0),w.value&&!v.value?(i(),n("div",wt,[e("div",kt,[e("div",Ct,[w.value.game.image?(i(),n("img",{key:0,src:N(w.value.game.id),alt:"Game Thumbnail",class:"w-32 mx-auto object-cover rounded-md mb-4"},null,8,Bt)):y("",!0),e("h2",Vt," Câștigător! - "+c(w.value.game.name),1),e("p",$t," User: "+c(w.value.for_user),1)])])])):y("",!0),L(xe,{show:Y(D),onClose:J},{title:z(()=>t[15]||(t[15]=[S(" Ești sigur că vrei să închizi forțat acest Bonus Battle? ")])),content:z(()=>t[16]||(t[16]=[S(" Vom închide forțat acest Bonus Battle și nu vei mai putea reveni la el. Ești sigur că vrei să continui? ")])),footer:z(()=>[e("button",{onClick:J,class:"btn-danger"}," ANULEAZĂ "),e("button",{class:"ml-3 btn-primary",onClick:de}," ÎNCHIDE FORȚAT ACEST BONUS BATTLE ")]),_:1},8,["show"]),v.value?(i(),n("div",St,[e("div",Ut,[e("div",At,[e("h2",Et,"Active Battle: "+c(v.value.title),1),e("button",{class:"btn-danger",onClick:ae}," INCHIDE TURNEU FORȚAT ")]),e("p",Ft," Miza: "+c(v.value.stake)+" | Etapa: "+c(W.value.name)+" | Premiu: "+c(v.value.prize)+" | Buys: "+c(v.value.buys),1),C.value.length>1?(i(),n("div",Tt,[(i(!0),n(U,null,A(C.value,(s,g)=>(i(),n("div",{key:g,class:_(["relative border rounded-md p-4 shadow transition-all duration-300 game-active-row",s.game.image?"bg-transparent":"bg-gray-900"]),style:te(s.game.image?{"--bg-image":"url("+N(s.game.id)+")"}:{})},[s.game.image?(i(),n("div",Nt)):y("",!0),e("div",{class:_(["relative z-10 p-4",s.game.image?"bg-black bg-opacity-60":"bg-gray-900"])},[e("div",zt,[s.game.image?(i(),n("img",{key:0,src:N(s.game.id),alt:"Game Thumbnail",class:"w-auto h-[100px] rounded-md"},null,8,Lt)):y("",!0),e("div",Wt,[e("h3",Pt,c(s.game.name)+" - "+c(s.for_user),1),e("div",Gt,[L(Y(se),{disabled:!G.value,options:K.value,label:"name",reduce:p=>p.id,"onUpdate:modelValue":p=>ce(s.id,p),placeholder:"Schimbi jocul?",class:"flex-1 transition-all duration-300","append-to-body":""},null,8,["disabled","options","reduce","onUpdate:modelValue"]),e("button",{class:"btn-secondary transition-all duration-300",onClick:t[8]||(t[8]=p=>G.value=!G.value)}," SCHIMBA JOCU ")])])]),e("div",null,[(i(!0),n(U,null,A(s.scores,(p,f)=>(i(),n("div",{key:f,class:"flex items-center space-x-2 mt-1 transition-all duration-300"},[e("label",Mt,[t[17]||(t[17]=S(" Cost Buy ")),B(e("input",{type:"number","onUpdate:modelValue":k=>s.scores[f].cost_buy=k,class:_(["block w-40 border border-gray-600 rounded-md shadow-sm p-2 transition-all duration-300 input-primary",{"input-disabled":r.value}]),disabled:r.value,placeholder:"Amount",onInput:k=>ee(g,f)},null,42,Rt),[[$,s.scores[f].cost_buy]])]),e("label",jt,[t[18]||(t[18]=S(" Rezultat Buy ")),B(e("input",{disabled:p.cost_buy<=0||r.value,class:_([{"input-disabled":p.cost_buy<=0||r.value,"input-primary":p.cost_buy>0},"block w-40 border border-gray-600 rounded-md shadow-sm p-2 transition-all duration-300"]),type:"number","onUpdate:modelValue":k=>s.scores[f].result_buy=k,placeholder:"Result",onInput:k=>ee(g,f)},null,42,Ht),[[$,s.scores[f].result_buy]])]),e("label",Dt,[t[19]||(t[19]=S(" Scor ")),B(e("input",{readonly:"",disabled:"",type:"number","onUpdate:modelValue":k=>s.scores[f].score=k,class:"block w-20 border border-gray-600 rounded-md shadow-sm p-2 input-disabled transition-all duration-300",placeholder:"Result"},null,8,Ot),[[$,s.scores[f].score]])]),f>=1?(i(),n("button",{key:0,type:"button",onClick:k=>le(g,f),class:"btn-danger transition-all duration-300 align-middle"},t[20]||(t[20]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1)]),8,Jt)):y("",!0)]))),128)),e("button",{type:"button",onClick:t[9]||(t[9]=p=>X()),disabled:r.value,class:_([{"input-disabled":r.value},"btn-primary mt-2"])}," Adaugă Buy ",10,qt)]),e("p",Yt," Scor Total: "+c(oe(s.scores)),1)],2)],6))),128))])):y("",!0),w.value?(i(),n("div",It,[e("p",Zt,"Câștigător: "+c(w.value.game.name)+" | User: "+c(w.value.for_user),1)])):y("",!0),e("div",Kt,[W.value.name!=="Final"?(i(),n("button",{key:0,type:"button",onClick:ue,class:_(["bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md transition-all duration-300",{"input-disabled opacity-50":!M.value||r.value}]),disabled:!M.value||r.value}," Următoarii Concurenți ",10,Qt)):y("",!0),W.value.name==="Final"?(i(),n("button",{key:1,type:"button",onClick:re,class:_(["bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md transition-all duration-300",{"input-disabled opacity-50":!M.value}]),disabled:!M.value}," Termina Battle ",10,Xt)):y("",!0)])]),e("div",es,[T.value.stage_brackets.length>0?(i(),n("table",ts,[e("tbody",null,[(i(!0),n(U,null,A(T.value.stage_brackets,(s,g)=>(i(),n("tr",{key:s.id,class:_(g%2===0?"bg-gray-900":"bg-gray-800")},[e("td",ss,[e("span",{class:_({"line-through text-gray-500":s.winner!==s.participant_a})},c(s.participant_a),3),t[21]||(t[21]=S(" vs ")),e("span",{class:_({"line-through text-gray-500":s.winner!==s.participant_b})},c(s.participant_b),3)]),e("td",as,c(parseFloat(s.participant_a_score).toFixed(3))+" - "+c(parseFloat(s.participant_b_score).toFixed(3)),1)],2))),128))])])):y("",!0),T.value.concurrents.length>0?(i(),n("table",ls,[e("tbody",null,[(i(!0),n(U,null,A(T.value.concurrents,(s,g)=>(i(),n("tr",{key:s==null?void 0:s.id,class:_(g%2===0?"bg-gray-900":"bg-gray-800")},[e("td",os,c(s!=null&&s.is_eliminated?"❌":"✅"),1),e("td",is,c((s==null?void 0:s.game.name)||"N/A"),1),e("td",ns,c((s==null?void 0:s.for_user)||"N/A"),1)],2))),128))])])):y("",!0)])])):y("",!0)])])]),_:1}))}};export{gs as default};
