import{S as _}from"./SvgBh-3a6b52c7.js";import{_ as y}from"./_plugin-vue_export-helper-c27b6911.js";import{N as x,e as u,a as t,Y as o,b as L,f as b,t as r,g,F as m,h as v,o as c,n as f}from"./app-3454b1d0.js";const B={components:{SvgBh:_},props:["id"],data(){return{loading:!0,bonusList:[],bonusListGames:[],allSettings:null,settings:{},isUpdating:!1,scrollSpeed:500,itWasDuplicated:!0}},computed:{startAmount(){return this.bonusList.start??0},huntOrBuy(){var e;return((e=this.allSettings)==null?void 0:e.bonus_list)==="buy"?"Buy":"Hunt"},duplicatedGames(){return this.shouldScroll()?(this.itWasDuplicated=!0,[...this.bonusListGames,...this.bonusListGames]):(this.itWasDuplicated=!1,this.bonusListGames)},firstEmptyResultId(){const e=this.bonusListGames.find(l=>l.result==="0");return e?e.id:null},gamesOpenedNr(){return this.bonusListGames.filter(e=>e.result&&e.result!=="0").length},gamesTotalNr(){return this.bonusListGames.length},gameHighestMulti(){const e=this.bonusListGames.map(l=>l!=null&&l.multiplier?parseFloat(l.multiplier.trim()):NaN).filter(l=>!isNaN(l));return e.length?Math.max(...e):0},progressPercentage(){return this.gamesOpenedNr/this.gamesTotalNr*100},averageMulti(){const e=this.bonusListGames.filter(a=>a.result!==null&&a.result!=="0");if(e.length===0)return 0;const l=e.reduce((a,h)=>a+parseFloat(h.multiplier),0);return Math.round(l/e.length)}},async mounted(){await this.getSettings(),await this.getLatestList(),this.loading=!1,await this.$nextTick(()=>{this.initAutoScroll(this.$refs.scrollWrapper),this.initAutoScroll(this.$refs.scrollWrapperHunt)}),await this.updateTheListFromTimeToTime()},methods:{shouldScroll(){const e=this.$refs.scrollWrapper||this.$refs.scrollWrapperHunt,l=this.$refs.viewport;if(!e||!l)return!1;const a=document.querySelector(".header-list"),h=a?a.getBoundingClientRect().height:0,n=l.getBoundingClientRect().bottom-h,p=e.querySelectorAll(".game-single");if(p.length===0)return!1;let i=0;return p.forEach(d=>{i+=d.getBoundingClientRect().height}),this.itWasDuplicated&&(i=i/2),i+20>n},async getSettings(){await axios.get("/api/settings/"+this.id).then(e=>{this.allSettings=e.data.settings,this.loadSettings()}).catch(e=>{console.log(e)})},async loadSettings(){this.settings=JSON.parse(this.allSettings.obs_bonus_list)},async getLatestList(){await axios.get("/api/bonus-list/"+this.id).then(e=>{this.bonusList=e.data.bonusList,this.bonusListGames=e.data.bonusListGames}).catch(e=>{console.log(e)})},async updateTheListFromTimeToTime(){setInterval(async()=>{this.isUpdating||(this.isUpdating=!0,await this.getLatestList(),this.isUpdating=!1,this.initAutoScroll())},8e3)},initAutoScroll(){const e=this.$refs.gamesList||this.$refs.gamesListHunt;e&&(this.shouldScroll()?e.classList.add("scrolling"):e.classList.remove("scrolling"))}}},S={class:"table-container"},C={class:"header-list"},k={key:0,class:"img-list"},w={class:"bonus-details"},H={class:"details"},F={class:"details"},G={class:"flex flex-col text-center"},z={class:"flex flex-col text-center"},N={class:"flex flex-col text-center"},T={class:"scroll-wrapper",ref:"scrollWrapper"},M={class:"number_game"},R={class:"name_game"},W={class:"stake"},A={class:"result"},D={class:"result"},E={class:"multi"},I={class:"scroll-wrapper",ref:"scrollWrapperHunt"},O={class:"number_game"},P={class:"name_game"},U={class:"stake"};function V(e,l,a,h,s,n){const p=x("SvgBh");return s.loading?b("",!0):(c(),u("div",{key:0,class:"table-list",style:o({"background-color":s.settings.tableBgColor,border:s.settings.borderEnabled?s.settings.borderWidth+"px "+s.settings.borderColor+" solid":"unset"}),ref:"viewport"},[t("div",S,[t("div",C,[t("div",{class:"header-list-title",style:o({"background-color":s.settings.headerBgColor,color:s.settings.headerFontColor,"font-size":s.settings.headerFontSize+"px"})},[s.settings.showIcon?(c(),u("span",k,[L(p)])):b("",!0),l[1]||(l[1]=t("span",null,"Bonus",-1)),t("span",null,r(n.huntOrBuy),1),t("div",w,[t("div",{class:"list-cost",style:o({"background-color":s.settings.headerCellBgColor})},[l[0]||(l[0]=g("Cost ")),t("span",null,r(n.startAmount)+" "+r(s.settings.currency),1)],4),t("div",{class:"list-opened",style:o({"background-color":s.settings.headerCellBgColor})},[t("div",H,[t("span",null,r(n.gamesOpenedNr)+"/",1)]),t("div",F,[t("span",null,r(n.gamesTotalNr),1)])],4)])],4),t("div",{class:"progress",style:o({height:s.settings.progressBarHeight+"px"})},[t("div",{class:"progress-bar-fill",style:o({width:n.progressPercentage+"%",background:"linear-gradient(90deg, "+s.settings.progressBarLow+" 0%, "+s.settings.progressBarHigh+" 100%)"})},null,4)],4),t("div",{class:"header-details",style:o({"background-color":s.settings.subheaderBgColor,color:s.settings.subheaderFontColor,"font-size":s.settings.subheaderFontSize+"px"})},[l[5]||(l[5]=t("div",{class:"flex flex-col text-center"},[g("Req (x)"),t("span",null,"112")],-1)),t("div",G,[l[2]||(l[2]=g("Avg (x)")),t("span",null,r(n.averageMulti),1)]),t("div",z,[l[3]||(l[3]=g("Top (x)")),t("span",null,r(n.gameHighestMulti),1)]),l[6]||(l[6]=t("div",{class:"flex flex-col text-center"},[g("Top (plata)"),t("span",null,"764")],-1)),t("div",N,[l[4]||(l[4]=g("Rezultat")),t("span",null,r(s.bonusList.result)+" lei",1)])],4)]),n.huntOrBuy==="Buy"?(c(),u(m,{key:0},[t("div",{class:"header",style:o({"background-color":s.settings.tableHeaderBgColor,color:s.settings.tableHeaderFontColor,"font-size":s.settings.tableHeaderFontSize+"px"})},l[7]||(l[7]=[t("div",{class:"header-content_buy header-content"},[t("div",{class:"text-center"},"#"),t("div",null,"Joc"),t("div",null,"Miză"),t("div",null,"Preț"),t("div",null,"Plată"),t("div",null,"Multi")],-1)]),4),t("div",T,[t("div",{class:"games",style:o({color:s.settings.tableBodyFontColor,"font-size":s.settings.tableBodyFontSize}),ref:"gamesList"},[(c(!0),u(m,null,v(n.duplicatedGames,(i,d)=>(c(),u("div",{key:"a-"+d,class:f(["game-single row-game_buy",{current:n.firstEmptyResultId===i.id}]),style:o({"border-bottom":"1px solid "+s.settings.tableDividerColor,"background-color":n.firstEmptyResultId===i.id?s.settings.tableCurrentGameColor:"unset"})},[t("div",M,r(d%s.bonusListGames.length+1),1),t("div",R,r(i.game.name),1),t("div",W,r(i.stake),1),t("div",A,r(i.price==="0"||i.price==null?"":i.price),1),t("div",D,r(i.result==="0"||i.result==null?"":i.result),1),t("div",E,r(i.multiplier==="0"||i.multiplier==null?"":"x"+i.multiplier),1)],6))),128))],4)],512)],64)):(c(),u(m,{key:1},[t("div",{class:"header",style:o({"background-color":s.settings.tableHeaderBgColor,color:s.settings.tableHeaderFontColor,"font-size":s.settings.tableHeaderFontSize+"px"})},l[8]||(l[8]=[t("div",{class:"header-content_hunt header-content"},[t("div",{class:"text-center"},"#"),t("div",null,"Joc"),t("div",null,"Miză"),t("div",null,"Plată"),t("div",null,"Multi")],-1)]),4),t("div",I,[t("div",{class:"games",style:o({color:s.settings.tableBodyFontColor,"font-size":s.settings.tableBodyFontSize}),ref:"gamesListHunt"},[(c(!0),u(m,null,v(n.duplicatedGames,(i,d)=>(c(),u("div",{key:"b-"+d,class:f(["game-single row-game_hunt",{current:n.firstEmptyResultId===i.id}]),style:o({"border-bottom":"1px solid "+s.settings.tableDividerColor})},[t("div",O,r(d%s.bonusListGames.length+1),1),t("div",P,r(i.game.name),1),t("div",U,r(i.stake),1),t("div",null,r(i.result==="0"||i.result==null?"":i.result),1),t("div",null,r(i.multiplier==="0"||i.multiplier==null?"":"x"+i.multiplier),1)],6))),128))],4)],512)],64))])],4))}const j=y(B,[["render",V]]);export{j as default};
