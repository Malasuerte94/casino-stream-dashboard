import _ from"./SvgBh-f337412d.js";import{_ as L}from"./_plugin-vue_export-helper-c27b6911.js";import{s as x,c as g,b as t,I as o,a as B,k as v,t as r,d as p,F as b,E as f,o as h,n as y}from"./app-c2b16b96.js";const S={components:{SvgBh:_},props:["id"],data(){return{loading:!0,bonusList:[],bonusListGames:[],allSettings:null,settings:{},isUpdating:!1,scrollSpeed:500,itWasDuplicated:!0}},computed:{startAmount(){return this.bonusList.start??0},huntOrBuy(){var l;return((l=this.allSettings)==null?void 0:l.bonus_list)==="buy"?"Buy":"Hunt"},duplicatedGames(){return this.shouldScroll()?(this.itWasDuplicated=!0,[...this.bonusListGames,...this.bonusListGames]):(this.itWasDuplicated=!1,this.bonusListGames)},firstEmptyResultId(){const l=this.bonusListGames.find(e=>e.result==="0");return l?l.id:null},gamesOpenedNr(){return this.bonusListGames.filter(l=>l.result&&l.result!=="0").length},gamesTotalNr(){return this.bonusListGames.length},gameHighestMulti(){const l=this.bonusListGames.map(e=>e!=null&&e.multiplier?parseFloat(e.multiplier.trim()):NaN).filter(e=>!isNaN(e));return l.length?Math.max(...l):0},gameHighestResult(){const l=this.bonusListGames.filter(e=>e.result&&e.result!=="0").map(e=>parseFloat(e.result));return l.length===0?0:Math.max(...l)},progressPercentage(){return this.gamesOpenedNr/this.gamesTotalNr*100},averageMulti(){const l=this.bonusListGames.filter(u=>u.result!==null&&u.result!=="0");if(l.length===0)return 0;const e=l.reduce((u,d)=>u+parseFloat(d.multiplier),0);return Math.round(e/l.length)},requiredAverageX(){const l=this.bonusList.start,e=this.bonusListGames.reduce((a,i)=>a+(i.result?parseFloat(i.result):0),0),u=Math.max(l-e,0),d=this.bonusListGames.filter(a=>!a.result||a.result==="0").length;if(d===0)return 0;const s=u/d;let n=0;return this.bonusListGames.forEach(a=>{const i=parseFloat(a.stake);if(a.result&&a.result!=="0")return;const c=s/i;n+=c}),Math.round(n/d)}},async mounted(){window.Echo.channel(`App.Models.User.${this.id}`).listen("BonusBuyOrHuntUpdated",async()=>{await this.updateList()}).listen("SettingsUpdated",async()=>{await this.updateList()}),await this.getSettings(),await this.getLatestList(),this.loading=!1,await this.$nextTick(()=>{this.initAutoScroll(this.$refs.scrollWrapper),this.initAutoScroll(this.$refs.scrollWrapperHunt)})},methods:{shouldScroll(){const l=this.$refs.scrollWrapper||this.$refs.scrollWrapperHunt,e=this.$refs.viewport;if(!l||!e)return!1;const u=document.querySelector(".header-list"),d=u?u.getBoundingClientRect().height:0,n=e.getBoundingClientRect().bottom-d,a=l.querySelectorAll(".game-single");if(a.length===0)return!1;let i=0;return a.forEach(c=>{i+=c.getBoundingClientRect().height}),this.itWasDuplicated&&(i=i/2),i+20>n},async getSettings(){await axios.get("/api/settings/"+this.id).then(l=>{this.allSettings=l.data.settings,this.loadSettings()}).catch(l=>{console.log(l)})},async loadSettings(){this.settings=JSON.parse(this.allSettings.obs_bonus_list)},async getLatestList(){await axios.get("/api/bonus-list/"+this.id).then(l=>{this.bonusList=l.data.bonusList,this.bonusListGames=l.data.bonusListGames}).catch(l=>{console.log(l)})},async updateList(){this.isUpdating||(this.isUpdating=!0,await this.getSettings(),await this.getLatestList(),this.isUpdating=!1,this.initAutoScroll())},initAutoScroll(){const l=this.$refs.gamesList||this.$refs.gamesListHunt;l&&(this.shouldScroll()?l.classList.add("scrolling"):l.classList.remove("scrolling"))}}},C={class:"table-container"},k={class:"header-list"},G={key:0,class:"img-list"},w={class:"bonus-details"},H={class:"details"},F={class:"details"},z={class:"flex flex-col text-center"},N={class:"flex flex-col text-center"},M={class:"flex flex-col text-center"},R={class:"flex flex-col text-center"},A={class:"flex flex-col text-center"},W={class:"number_game"},E={class:"name_game"},O={class:"stake"},q={class:"result"},D={class:"result"},I={class:"multi"},P={class:"number_game"},T={class:"name_game"},U={class:"stake"};function V(l,e,u,d,s,n){const a=x("SvgBh");return s.loading?v("",!0):(h(),g("div",{key:0,class:"table-list",style:o({border:s.settings.borderEnabled?s.settings.borderWidth+"px "+s.settings.borderColor+" solid":"unset"}),ref:"viewport"},[t("div",C,[t("div",k,[t("div",{class:"header-list-title",style:o({"background-color":s.settings.headerBgColor,color:s.settings.headerFontColor,"font-size":s.settings.headerFontSize+"px"})},[s.settings.showIcon?(h(),g("span",G,[B(a)])):v("",!0),e[1]||(e[1]=t("span",null,"Bonus",-1)),t("span",null,r(n.huntOrBuy),1),t("div",w,[t("div",{class:"list-cost",style:o({"background-color":s.settings.headerCellBgColor})},[e[0]||(e[0]=p("Cost ")),t("span",null,r(n.startAmount)+" "+r(s.settings.currency),1)],4),t("div",{class:"list-opened",style:o({"background-color":s.settings.headerCellBgColor})},[t("div",H,[t("span",null,r(n.gamesOpenedNr)+"/",1)]),t("div",F,[t("span",null,r(n.gamesTotalNr),1)])],4)])],4),t("div",{class:"progress",style:o({height:s.settings.progressBarHeight+"px"})},[t("div",{class:"progress-bar-fill",style:o({width:n.progressPercentage+"%",background:"linear-gradient(90deg, "+s.settings.progressBarLow+" 0%, "+s.settings.progressBarHigh+" 100%)"})},null,4)],4),t("div",{class:"header-details",style:o({"background-color":s.settings.subheaderBgColor,color:s.settings.subheaderFontColor,"font-size":s.settings.subheaderFontSize+"px"})},[t("div",z,[e[2]||(e[2]=p("Req (x)")),t("span",null,r(n.requiredAverageX),1)]),t("div",N,[e[3]||(e[3]=p("Avg (x)")),t("span",null,r(n.averageMulti),1)]),t("div",M,[e[4]||(e[4]=p("Top (x)")),t("span",null,r(n.gameHighestMulti),1)]),t("div",R,[e[5]||(e[5]=p("Top (plata)")),t("span",null,r(n.gameHighestResult)+" "+r(s.settings.currency),1)]),t("div",A,[e[6]||(e[6]=p("Rezultat")),t("span",null,r(s.bonusList.result)+" "+r(s.settings.currency),1)])],4)]),n.huntOrBuy==="Buy"?(h(),g(b,{key:0},[t("div",{class:"header",style:o({"background-color":s.settings.tableHeaderBgColor,color:s.settings.tableHeaderFontColor,"font-size":s.settings.tableHeaderFontSize+"px"})},e[7]||(e[7]=[t("div",{class:"header-content_buy header-content"},[t("div",{class:"text-center"},"#"),t("div",null,"Joc"),t("div",null,"Miză"),t("div",null,"Preț"),t("div",null,"Plată"),t("div",null,"Multi")],-1)]),4),t("div",{class:"scroll-wrapper",ref:"scrollWrapper",style:o({"background-color":s.settings.tableBgColor})},[t("div",{class:"games",style:o({color:s.settings.tableBodyFontColor,"font-size":s.settings.tableBodyFontSize+"px"}),ref:"gamesList"},[(h(!0),g(b,null,f(n.duplicatedGames,(i,c)=>{var m;return h(),g("div",{key:"a-"+c,class:y(["game-single row-game_buy",{current:n.firstEmptyResultId===i.id}]),style:o({"border-bottom":"1px solid "+s.settings.tableDividerColor,"background-color":n.firstEmptyResultId===i.id?s.settings.tableCurrentGameColor:"unset"})},[t("div",W,r(c%s.bonusListGames.length+1),1),t("div",E,r(((m=i.game)==null?void 0:m.name)??"N/A"),1),t("div",O,r(i.stake),1),t("div",q,r(i.price==="0"||i.price==null?"":i.price),1),t("div",D,r(i.result==="0"||i.result==null?"":i.result),1),t("div",I,r(i.multiplier==="0"||i.multiplier==null?"":"x"+i.multiplier),1)],6)}),128))],4)],4)],64)):(h(),g(b,{key:1},[t("div",{class:"header",style:o({"background-color":s.settings.tableHeaderBgColor,color:s.settings.tableHeaderFontColor,"font-size":s.settings.tableHeaderFontSize+"px"})},e[8]||(e[8]=[t("div",{class:"header-content_hunt header-content"},[t("div",{class:"text-center"},"#"),t("div",null,"Joc"),t("div",null,"Miză"),t("div",null,"Plată"),t("div",null,"Multi")],-1)]),4),t("div",{class:"scroll-wrapper",ref:"scrollWrapperHunt",style:o({"background-color":s.settings.tableBgColor})},[t("div",{class:"games",style:o({color:s.settings.tableBodyFontColor,"font-size":s.settings.tableBodyFontSize+"px"}),ref:"gamesListHunt"},[(h(!0),g(b,null,f(n.duplicatedGames,(i,c)=>{var m;return h(),g("div",{key:"b-"+c,class:y(["game-single row-game_hunt",{current:n.firstEmptyResultId===i.id}]),style:o({"border-bottom":"1px solid "+s.settings.tableDividerColor})},[t("div",P,r(c%s.bonusListGames.length+1),1),t("div",T,r(((m=i.game)==null?void 0:m.name)??"N/A"),1),t("div",U,r(i.stake),1),t("div",null,r(i.result==="0"||i.result==null?"":i.result),1),t("div",null,r(i.multiplier==="0"||i.multiplier==null?"":"x"+i.multiplier),1)],6)}),128))],4)],4)],64))])],4))}const K=L(S,[["render",V]]);export{K as default};
