import{e as l,a as e,t as i,k as c,E as f,F as _,h as g,o as a,f as m,g as y}from"./app-08221b8b.js";import{_ as x}from"./_plugin-vue_export-helper-c27b6911.js";const b={props:["id"],data(){return{list:[],topReferrers:[],filteredList:[],user:"",filter:{from:"",to:""}}},async mounted(){await this.getReferrals()},methods:{async getReferrals(){try{const r=await axios.get(`/api/ref-list/${this.id}`);this.list=r.data.list,this.user=r.data.user,this.filteredList=this.list,this.calculateTopReferrers()}catch(r){console.log(r)}},calculateTopReferrers(){const r=this.list.reduce((t,o)=>(t[o.parent_user]=(t[o.parent_user]||0)+1,t),{});this.topReferrers=Object.entries(r).map(([t,o])=>({parent_user:t,count:o})).sort((t,o)=>o.count-t.count)},filterReferrals(){const r=new Date(this.filter.from),t=new Date(this.filter.to);this.filteredList=this.list.filter(o=>{const d=o.created_at?new Date(o.created_at):null;return(!r||!d||d>=r)&&(!t||!d||d<=t)})}}},h={class:"py-2 bg-gray-900 text-gray-200 min-h-screen"},R={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},v={class:"bg-gray-800 shadow-xl rounded-lg p-6"},w={class:"flex justify-between items-center mb-6"},D={class:"text-3xl font-bold"},k={class:"flex space-x-4 items-center"},L={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},T={class:"bg-gray-700 p-4 rounded-lg shadow"},V={key:0},A={key:1},C={key:2},F={class:"bg-gray-700 p-4 rounded-lg shadow"},N={class:"w-full text-left text-sm"},U={class:"px-4 py-2"},j={class:"px-4 py-2"},B={class:"px-4 py-2"};function E(r,t,o,d,n,u){return a(),l("div",h,[e("div",R,[e("div",v,[e("div",w,[e("h1",D,"Referrals pentru "+i(n.user),1),e("div",k,[t[3]||(t[3]=e("label",{for:"fromDate",class:"text-sm font-medium"},"From:",-1)),c(e("input",{id:"fromDate",type:"date","onUpdate:modelValue":t[0]||(t[0]=s=>n.filter.from=s),class:"bg-gray-700 text-gray-200 px-3 py-1 rounded-md border border-gray-600"},null,512),[[f,n.filter.from]]),t[4]||(t[4]=e("label",{for:"toDate",class:"text-sm font-medium"},"To:",-1)),c(e("input",{id:"toDate",type:"date","onUpdate:modelValue":t[1]||(t[1]=s=>n.filter.to=s),class:"bg-gray-700 text-gray-200 px-3 py-1 rounded-md border border-gray-600"},null,512),[[f,n.filter.to]]),e("button",{onClick:t[2]||(t[2]=(...s)=>u.filterReferrals&&u.filterReferrals(...s)),class:"bg-blue-500 hover:bg-blue-600 px-4 py-2 rounded-md text-white"}," Filter ")])]),e("div",L,[e("div",T,[t[5]||(t[5]=e("h2",{class:"text-xl font-bold mb-4"},"Referrers Leaderboard",-1)),e("ul",null,[(a(!0),l(_,null,g(n.topReferrers,(s,p)=>(a(),l("li",{key:s.parent_user,class:"flex justify-between items-center p-2 rounded-md hover:bg-gray-600"},[e("span",null,[p===0?(a(),l("span",V,"ğŸ¥‡")):p===1?(a(),l("span",A,"ğŸ¥ˆ")):p===2?(a(),l("span",C,"ğŸ¥‰")):m("",!0),y(" "+i(s.parent_user),1)]),e("span",null,i(s.count)+" Referrals",1)]))),128))])]),e("div",F,[t[7]||(t[7]=e("h2",{class:"text-xl font-bold mb-4"},"All Referrals",-1)),e("table",N,[t[6]||(t[6]=e("thead",{class:"bg-gray-800 text-gray-300"},[e("tr",null,[e("th",{class:"px-4 py-2"},"Parent User"),e("th",{class:"px-4 py-2"},"Referred User"),e("th",{class:"px-4 py-2"},"Created At")])],-1)),e("tbody",null,[(a(!0),l(_,null,g(n.filteredList,s=>(a(),l("tr",{key:s.id,class:"hover:bg-gray-600"},[e("td",U,i(s.parent_user),1),e("td",j,i(s.referred_user),1),e("td",B,i(s.created_at?new Date(s.created_at).toLocaleDateString():"N/A"),1)]))),128))])])])])])])])}const M=x(b,[["render",E],["__scopeId","data-v-bf42b401"]]);export{M as default};
